/*
This software has been approved for release by the U.S. Department of the Interior. Although the software has been subjected to rigorous review, the DOI reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the DOI or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the DOI nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios"),require("q")):"function"==typeof define&&define.amd?define("@geoplatform/client",["exports","axios","q"],t):t((e.geoplatform=e.geoplatform||{},e.geoplatform.client={}),e.axios,e.Q)}(this,function(e,r,u){"use strict";r=r&&r.hasOwnProperty("default")?r["default"]:r;var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o,s=(t(n,o=Error),n.prototype.setError=function(e){this.error=e},n.prototype.setStatus=function(e){this.status=this.statusCode=e},n);function n(e){var t=o.call(this,e)||this;return t.status=500,t.statusCode=500,t.error=null,t}var a={DATASET:"dcat:Dataset",SERVICE:"regp:Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",ORGANIZATION:"org:Organization",CONTACT:"vcard:VCard",PERSON:"foaf:Person",CONCEPT:"skos:Concept",CONCEPT_SCHEME:"skos:ConceptScheme",STANDARD:"dct:Standard",RIGHTS_STATEMENT:"dct:RightsStatement"},c={};c[a.DATASET]="Dataset",c[a.SERVICE]="Service",c[a.LAYER]="Layer",c[a.MAP]="Map",c[a.GALLERY]="Gallery",c[a.COMMUNITY]="Community",c[a.APPLICATION]="Application",c[a.TOPIC]="Topic",c[a.WEBSITE]="WebSite",c[a.ORGANIZATION]="Organization",c[a.CONTACT]="Contact",c[a.PERSON]="Person",c[a.CONCEPT]="Concept",c[a.CONCEPT_SCHEME]="Concept Scheme",c[a.STANDARD]="Standard",c[a.RIGHTS_STATEMENT]="Rights Statement";var p="http://www.geoplatform.gov",l=["http://www.geoplatform.gov/spec/esri-feature-rest","http://www.geoplatform.gov/spec/esri-image-rest","http://www.geoplatform.gov/spec/esri-map-rest","http://www.geoplatform.gov/spec/esri-tile-rest"];function h(e){if(null===e)return"";if("string"==typeof e)return e.toLowerCase().replace(/\s/g,"");if("object"!=typeof e)return"";var t="";for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];null!=i&&(t+=(i+"").toLowerCase().replace(/\s/g,""))}return t}function f(e){!function o(e){if(!e)return;var t=e.serviceType||e.conformsTo;if(!t)return;if(0<=l.indexOf(t.uri)){var r=e.href||e.accessURL,i=r.match(/(Map|Feature|Image)(Server\/\d+)/i);i&&2<i.length&&(r=r.replace(i[2],"Server/"),e.href&&(e.href=r),e.accessURL&&(e.accessURL=r))}}(e);var t=e.accessURL||e.href;if(!t||!t.length)return null;var r=(t=(t=(t=(t+"").trim().toLowerCase()).replace(/http(s)?:\/\//,"")).replace(/&?request=[A-Za-z]+/i,"").replace(/&?service=(WMS|WFS|WCS|CSW)/i,"").replace(/&?version=[0-9\.]*/i,"").replace(/&?layers=[A-Za-z0-9\-\:_,]*/i,"").replace(/&?srs=[A-Za-z0-9\:]*/i,"").replace(/&?crs=[A-Za-z0-9\:]*/i,"").replace(/&?format=[A-Za-z\/]*/i,"").replace(/&?bbox=[0-9,\.]*/i,""))[t.length-1];return"/"!==r&&"?"!==r||(t=t.substring(0,t.length-1)),t}var E={factories:{},register:function(e,t){this.factories[e]=t},create:function(e,t){if(!e||!e.type)return null;if("function"!=typeof t)throw new Error("Must specify a MD5 function when using URIFactory");var r=this.factories[e.type];return r?r(e,t):null}};E.register(a.DATASET,function(e,t){var r=(e.publisher||e.publishers||[]).map(function(e){return e.label||""}).join(""),i=h({title:e.title,pub:r});return p+"/id/dataset/"+t(i)}),E.register(a.SERVICE,function(e,t){var r=h(f(e));return p+"/id/service/"+t(r)}),E.register(a.LAYER,function(e,t){var r="",i=e.servicedBy||e.services;i&&i.length&&(r=i[0].accessURL||i[0].href||"");var o=e.accessURL||e.href||"",s=r+(e.layerName||"")+o;if(!s.length)return null;var n=h(s);return p+"/id/layer/"+t(n)}),E.register(a.MAP,function(e,t){var r=e.createdBy||e._createdBy||"",i=(e.identifiers||e.identifier||[]).join(""),o=h({title:e.title,author:r,identifiers:i});return p+"/id/map/"+t(o)}),E.register(a.GALLERY,function(e,t){var r=e.createdBy||e._createdBy||"",i=h({title:e.title,author:r});return p+"/id/gallery/"+t(i)}),E.register(a.COMMUNITY,function(e,t){var r=h({title:e.title});return p+"/id/community/"+t(r)}),E.register(a.ORGANIZATION,function(e,t){var r=h(e.label||e.name);return p+"/id/organization/"+t(r)}),E.register(a.PERSON,function(e,t){var r=h(e.name);return p+"/id/person/"+t(r)}),E.register(a.CONTACT,function(e,t){var r={};return(e.email||e.hasEmail)&&(r.email=e.email||e.hasEmail),e.tel&&(r.tel=e.tel),(e.orgName||e["organization-name"])&&(r.orgName=e.orgName||e["organization-name"]),e.positionTitle&&(r.positionTitle=e.positionTitle),r=h(r),p+"/id/contact/"+t(r)}),E.register(a.CONCEPT,function(e,t){var r=e.inScheme||e.scheme,i=h(r?r.label||r.prefLabel:""),o=h(e.label||e.prefLabel);return p+"/id/metadata-codelists/"+t(i)+"/"+t(o)}),E.register(a.CONCEPT_SCHEME,function(e,t){var r=h(e.label||e.prefLabel);return p+"/id/metadata-codelists/"+t(r)}),E.register(a.APPLICATION,function(e,t){if(!e||!e.title)return null;var r=e.createdBy||e._createdBy||"",i=h({title:e.title,author:r});return p+"/id/application/"+t(i)}),E.register(a.TOPIC,function(e,t){if(!e||!e.title)return null;var r=e.createdBy||e._createdBy||"",i=h({title:e.title,author:r});return p+"/id/topic/"+t(i)}),E.register(a.WEBSITE,function(e,t){if(!e||!e.landingPage)return null;var r=h(e.landingPage);return p+"/id/website/"+t(r)});var y={ALTERNATE_TITLE:"alternateTitles",BEGINS:"startDate.min",CLASSIFIERS:"classifiers",CREATED:"created",CREATED_BEFORE:"created.max",CREATED_AFTER:"created.min",CREATED_BY:"createdBy",CREATOR:"creator.id",CONTRIBUTED_BY:"contributedBy",ENDS:"endDate.max",EXTENT:"extent",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LAST_MODIFIED_BY:"lastModifiedBy",MODIFIED:"modified",MODIFIED_BEFORE:"modified.max",MODIFIED_AFTER:"modified.min",PUBLISHERS_ID:"publisher.id",PUBLISHERS_LABEL:"publisher.label",PUBLISHERS_URI:"publisher.uri",CONTACTS_ID:"contacts.id",CONTACTS_LABEL:"contacts.label",CONTACTS_URI:"contacts.uri",QUERY:"q",SCHEMES_ID:"scheme.id",SCHEMES_LABEL:"scheme.label",SCHEMES_URI:"scheme.uri",SIMILAR_TO:"similarTo",STATUS:"status",SERVICE_TYPES:"serviceType.id",THEMES_ID:"theme.id",THEMES_LABEL:"theme.label",THEMES_URI:"theme.uri",TOPICS_ID:"topic.id",TOPICS_LABEL:"topic.label",TOPICS_URI:"topic.uri",TYPES:"type",URI:"uri",USED_BY_ID:"usedBy.id",USED_BY_LABEL:"usedBy.label",USED_BY_URI:"usedBy.uri",VISIBILITY:"visibility",RESOURCE_TYPE:"resourceType",DATASET:"dataset",LANDING_PAGE:"landingPage",PURPOSE:"purpose",RELIABILITY:"reliability",RELIABILITY_MIN:"reliability.min",RELIABILITY_MAX:"reliability.max",ONLINE:"online",COMPLIANT:"compliant",SPEED:"speed",SPEED_MIN:"speed.min",SPEED_MAX:"speed.max",LIKES:"likes",LIKES_MIN:"likes.min",LIKES_MAX:"likes.max",VIEWS:"views",VIEWS_MIN:"views.min",VIEWS_MAX:"views.max",HREF:"href",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",PARENT_LAYER:"parentLayer",SUB_LAYER:"subLayer",SERVICE:"service",MAP_LAYER:"mapLayer",GALLERY_ITEM:"galleryItem",FACETS:"includeFacets",FIELDS:"fields",SORT:"sort",PAGE:"page",PAGE_SIZE:"size",FOR_TYPES:"for"},g=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],m=(d.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},d.prototype.parameter=function(e,t){return this.setParameter(e,t),this},d.prototype.setParameter=function(e,t){null===t||t===undefined?delete this.query[e]:this.query[e]=t},d.prototype.getParameter=function(e){return this.query[e]},d.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},d.prototype.q=function(e){return this.setQ(e),this},d.prototype.setQ=function(e){this.setParameter(y.QUERY,e)},d.prototype.getQ=function(){return this.getParameter(y.QUERY)},d.prototype.classifiers=function(e){return this.setClassifiers(e),this},d.prototype.setClassifiers=function(e){e&&("string"==typeof e&&(e=e=[e]),this.setParameter(y.TYPES,e))},d.prototype.getClassifiers=function(){return this.getParameter(y.TYPES)},d.prototype.types=function(e){return this.setTypes(e),this},d.prototype.setTypes=function(e){e&&("string"==typeof e&&(e=[e]),this.setParameter(y.FOR_TYPES,e))},d.prototype.getTypes=function(){return this.getParameter(y.FOR_TYPES)},d.prototype.page=function(e){return this.setPage(e),this},d.prototype.setPage=function(e){isNaN(e)||1*e<0||(this.query.page=1*e)},d.prototype.getPage=function(){return this.query.page},d.prototype.nextPage=function(){this.setPage(this.query.page+1)},d.prototype.previousPage=function(){this.setPage(this.query.page-1)},d.prototype.pageSize=function(e){return this.setPageSize(e),this},d.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this.query.size=1*e)},d.prototype.getPageSize=function(){return this.query.size},d.prototype.sort=function(e,t){return this.setSort(e,t),this},d.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.query.sort=e},d.prototype.getSort=function(){return this.query.sort},d.prototype.getSortField=function(){return this.query.sort.split(",")[0]},d.prototype.getSortOrder=function(){return"asc"===this.query.sort.split(",")[1]},d.prototype.getSortOptions=function(){return g.slice(0)},d.prototype.clear=function(){this.query=this.defaultQuery},d);function d(){this.defaultQuery={page:0,size:10,sort:"modified,desc"},this.query={page:0,size:10,sort:"modified,desc"}}var v={PURPOSE:"purpose",FUNCTION:"function",TOPIC_PRIMARY:"primaryTopic",TOPIC_SECONDARY:"secondaryTopic",SUBJECT_PRIMARY:"primarySubject",SUBJECT_SECONDARY:"secondarySubject",COMMUNITY:"community",AUDIENCE:"audience",PLACE:"place",CATEGORY:"category"},S={ACCESS_RIGHTS:"rights",ALTERNATE_TITLES:"alternateTitles",ANNOTATIONS:"annotations",CLASSIFIERS:"classifiers",CONCEPT_SCHEME:"scheme",CONTACTS:"contacts",CREATED:"created",CREATED_BY:"createdBy",DATASETS:"datasets",DESCRIPTION:"description",DISTRIBUTIONS:"distributions",EXTENT:"extent",GALLERY_ITEMS:"items",HREF:"href",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LABEL:"label",LAST_MODIFIED_BY:"lastModifiedBy",LAYERS:"layers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LEGEND:"legend",MODIFIED:"modified",PARENT_LAYER:"parentLayer",PUBLISHERS:"publishers",RESOURCE_TYPES:"resourceTypes",SERVICE_TYPE:"serviceType",SERVICES:"services",SPATIAL:"spatial",STATISTICS:"statistics",STATUS:"status",SUB_LAYERS:"subLayers",TEMPORAL:"temporal",THEMES:"themes",THUMBNAIL:"thumbnail",TOPICS:"topics",USED_BY:"usedBy",VISIBILITY:"visibility",LANDING_PAGE:"landingPage"},T=[S.CREATED,S.MODIFIED,S.CREATED_BY,S.PUBLISHERS,S.THEMES,S.DESCRIPTION],P={ALTERNATE_TITLES:"alternateTitles",CONCEPT_SCHEMES:"schemes",CREATED_BY:"createdBy",HREF:"href",IDENTIFIERS:"identifiers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LIKES:"likes",ONLINE:"online",PUBLISHERS:"publishers",CONTACTS:"contacts",RELIABILITY:"reliability",SERVICE_TYPES:"serviceTypes",SPEED:"speed",STATUS:"status",THEMES:"themes",TOPICS:"topics",TYPES:"type",USED_BY:"usedBy",VIEWS:"views",VISIBILITY:"visibility"},I=[P.TYPES,P.PUBLISHERS,P.SERVICE_TYPES,P.CONCEPT_SCHEMES,P.VISIBILITY,P.CREATED_BY],R={};R[P.TYPES]=y.TYPES,R[P.THEMES]=y.THEMES_ID,R[P.TOPICS]=y.TOPICS_ID,R[P.PUBLISHERS]=y.PUBLISHERS_ID,R[P.CONTACTS]=y.CONTACTS_ID,R[P.CONCEPT_SCHEMES]=y.SCHEMES_ID,R[P.USED_BY]=y.USED_BY_ID;var b=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],O=/^\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?$/;function A(e){var t=e;return null!==t&&"undefined"==typeof t.push&&(t=[t]),null===t||t.length||(t=null),t}var C=(_.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},_.prototype.clone=function(){var e=new _,t=JSON.parse(JSON.stringify(this.query));return e.applyParameters(t),e},_.prototype.parameter=function(e,t){return this.setParameter(e,t),this},_.prototype.setParameter=function(e,t){null===t||t===undefined||"undefined"!=typeof t.push&&!t.length?delete this.query[e]:this.query[e]=t},_.prototype.getParameter=function(e){return this.query[e]},_.prototype.clearParameter=function(e){delete this.query[e]},_.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},_.prototype.setFacetParameter=function(e,t){var r=R[e];r||console.log("WARN : Query.applyFacetParameter() - unable to map facet to known parameter '"+e+"', using as direct parameter which may not operate as intended"),this.setParameter(r||e,t)},_.prototype.q=function(e){return this.setQ(e),this},_.prototype.setQ=function(e){this.setParameter(y.QUERY,e)},_.prototype.getQ=function(){return this.getParameter(y.QUERY)},_.prototype.keywords=function(e){return this.setKeywords(e),this},_.prototype.setKeywords=function(e){this.setParameter(y.KEYWORDS,A(e))},_.prototype.getKeywords=function(){return this.getParameter(y.KEYWORDS)},_.prototype.uri=function(e){return this.setUri(e),this},_.prototype.setUri=function(e){this.setParameter(y.URI,e)},_.prototype.getUri=function(){return this.getParameter(y.URI)},_.prototype.types=function(e){return this.setTypes(e),this},_.prototype.setTypes=function(e){this.setParameter(y.TYPES,A(e))},_.prototype.getTypes=function(){return this.getParameter(y.TYPES)},_.prototype.createdBy=function(e){return this.setCreatedBy(e),this},_.prototype.setCreatedBy=function(e){this.setParameter(y.CREATED_BY,e)},_.prototype.getCreatedBy=function(){return this.getParameter(y.CREATED_BY)},_.prototype.lastModifiedBy=function(e){return this.setLastModifiedBy(e),this},_.prototype.setLastModifiedBy=function(e){this.setParameter(y.LAST_MODIFIED_BY,e)},_.prototype.getLastModifiedBy=function(){return this.getParameter(y.LAST_MODIFIED_BY)},_.prototype.themes=function(e,t){return this.setThemes(e,t),this},_.prototype.setThemes=function(e,t){this.setParameter(y.THEMES_ID,null),this.setParameter(y.THEMES_LABEL,null),this.setParameter(y.THEMES_URI,null);var r=t||y.THEMES_ID;this.setParameter(r,A(e))},_.prototype.getThemes=function(){return this.getParameter(y.THEMES_ID)||this.getParameter(y.THEMES_LABEL)||this.getParameter(y.THEMES_URI)},_.prototype.topics=function(e,t){return this.setTopics(e,t),this},_.prototype.setTopics=function(e,t){this.setParameter(y.TOPICS_ID,null),this.setParameter(y.TOPICS_LABEL,null),this.setParameter(y.TOPICS_URI,null);var r=t||y.TOPICS_ID;this.setParameter(r,A(e))},_.prototype.getTopics=function(){return this.getParameter(y.TOPICS_ID)||this.getParameter(y.TOPICS_LABEL)||this.getParameter(y.TOPICS_URI)},_.prototype.publishers=function(e,t){return this.setPublishers(e,t),this},_.prototype.setPublishers=function(e,t){this.setParameter(y.PUBLISHERS_ID,null),this.setParameter(y.PUBLISHERS_LABEL,null),this.setParameter(y.PUBLISHERS_URI,null);var r=t||y.PUBLISHERS_ID;this.setParameter(r,A(e))},_.prototype.getPublishers=function(){return this.getParameter(y.PUBLISHERS_ID)||this.getParameter(y.PUBLISHERS_LABEL)||this.getParameter(y.PUBLISHERS_URI)},_.prototype.contacts=function(e,t){return this.setContacts(e,t),this},_.prototype.setContacts=function(e,t){this.setParameter(y.CONTACTS_ID,null),this.setParameter(y.CONTACTS_LABEL,null),this.setParameter(y.CONTACTS_URI,null);var r=t||y.CONTACTS_ID;this.setParameter(r,A(e))},_.prototype.getContacts=function(){return this.getParameter(y.CONTACTS_ID)||this.getParameter(y.CONTACTS_LABEL)||this.getParameter(y.CONTACTS_URI)},_.prototype.usedBy=function(e,t){return this.setUsedBy(e,t),this},_.prototype.setUsedBy=function(e,t){this.setParameter(y.USED_BY_ID,null),this.setParameter(y.USED_BY_LABEL,null),this.setParameter(y.USED_BY_URI,null);var r=t||y.USED_BY_ID;this.setParameter(r,A(e))},_.prototype.getUsedBy=function(){return this.getParameter(y.USED_BY_ID)||this.getParameter(y.USED_BY_LABEL)||this.getParameter(y.USED_BY_URI)},_.prototype.schemes=function(e,t){return this.setSchemes(e,t),this},_.prototype.setSchemes=function(e,t){this.setParameter(y.SCHEMES_ID,null),this.setParameter(y.SCHEMES_LABEL,null),this.setParameter(y.SCHEMES_URI,null);var r=t||y.SCHEMES_ID;this.setParameter(r,A(e))},_.prototype.getSchemes=function(){return this.getParameter(y.SCHEMES_ID)||this.getParameter(y.SCHEMES_LABEL)||this.getParameter(y.SCHEMES_URI)},_.prototype.serviceTypes=function(e){return this.setServiceTypes(e),this},_.prototype.setServiceTypes=function(e){this.setParameter(y.SERVICE_TYPES,A(e))},_.prototype.getServiceTypes=function(){return this.getParameter(y.SERVICE_TYPES)},_.prototype.visibility=function(e){return this.setVisibility(e),this},_.prototype.setVisibility=function(e){this.setParameter(y.VISIBILITY,e)},_.prototype.getVisibility=function(){return this.getParameter(y.VISIBILITY)},_.prototype.status=function(e){return this.setStatus(e),this},_.prototype.setStatus=function(e){this.setParameter(y.STATUS,e)},_.prototype.getStatus=function(){return this.getParameter(y.STATUS)},_.prototype.extent=function(e){return this.setExtent(e),this},_.prototype.setExtent=function(e){if(e)if("undefined"!=typeof e.toBboxString)e=e.toBboxString();else if("undefined"!=typeof e.push&&e.length&&"undefined"!=typeof e[0].push)e=e[0][1]+","+e[0][0]+","+e[1][1]+","+e[1][0];else{if("string"!=typeof e)throw new Error("Invalid argument: bbox must be one of Leaflet.Bounds, nested array, or bbox string");if(!O.test(e))throw new Error("Invalid argument: bbox string must be in form of 'minx,miny,maxx,maxy'")}this.setParameter(y.EXTENT,e)},_.prototype.getExtent=function(){return this.getParameter(y.EXTENT)},_.prototype.classifier=function(e,t){return this.setClassifier(e,t),this},_.prototype.setClassifier=function(e,t){var r=A(t);this.setParameter(y.CLASSIFIERS+"."+e,r)},_.prototype.getClassifier=function(e){return this.getParameter(y.CLASSIFIERS+"."+e)||[]},_.prototype.classifiers=function(e){return this.setClassifiers(e),this},_.prototype.setClassifiers=function(t){var r=this,i=Object.keys(v).map(function(e){return v[e]});t&&"object"==typeof t&&!Array.isArray(t)?Object.keys(t).forEach(function(e){~i.indexOf(e)&&r.setClassifier(e,t[e])}):i.forEach(function(e){r.clearParameter(y.CLASSIFIERS+"."+e)})},_.prototype.getClassifiers=function(){var t=this,r={};return Object.keys(v).map(function(e){return v[e]}).forEach(function(e){r[e]=t.getClassifier(e)}),r},_.prototype.modified=function(e,t){return this.setModified(e,t),this},_.prototype.setModified=function(e,t){if(!e)return this.setParameter(y.MODIFIED_BEFORE,null),void this.setParameter(y.MODIFIED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?y.MODIFIED_BEFORE:y.MODIFIED_AFTER,o=r?y.MODIFIED_AFTER:y.MODIFIED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},_.prototype.getModified=function(){var e=this.getParameter(y.MODIFIED_BEFORE)||this.getParameter(y.MODIFIED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},_.prototype.created=function(e,t){return this.setCreated(e,t),this},_.prototype.setCreated=function(e,t){if(!e)return this.setParameter(y.CREATED_BEFORE,null),void this.setParameter(y.CREATED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?y.CREATED_BEFORE:y.CREATED_AFTER,o=r?y.CREATED_AFTER:y.CREATED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},_.prototype.getCreated=function(){var e=this.getParameter(y.CREATED_BEFORE)||this.getParameter(y.CREATED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},_.prototype.begins=function(e){return this.setBeginDate(e),this},_.prototype.setBeginDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(y.BEGINS,e)},_.prototype.getBeginDate=function(){var e=this.getParameter(y.BEGINS);return e&&(e=new Date(e)),e},_.prototype.ends=function(e){return this.setEndDate(e),this},_.prototype.setEndDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(y.ENDS,e)},_.prototype.getEndDate=function(){var e=this.getParameter(y.ENDS);return e&&(e=new Date(e)),e},_.prototype.between=function(e,t){return this.setBetween(e,t),this},_.prototype.setBetween=function(e,t){this.begins(e),this.ends(t)},_.prototype.resourceTypes=function(e){return this.setResourceTypes(e),this},_.prototype.setResourceTypes=function(e){this.setParameter(y.RESOURCE_TYPE,A(e))},_.prototype.getResourceTypes=function(){return this.getParameter(y.RESOURCE_TYPE)},_.prototype.facets=function(e){return this.setFacets(e),this},_.prototype.setFacets=function(e){this.setParameter(y.FACETS,A(e))},_.prototype.getFacets=function(){return this.getParameter(y.FACETS)},_.prototype.addFacet=function(e){var t=this.getFacets()||[];t.push(e),this.setFacets(t)},_.prototype.removeFacet=function(e){var t=this.getFacets()||[],r=t.indexOf(e);0<=r&&(t.splice(r,1),this.setFacets(t))},_.prototype.fields=function(e){return this.setFields(e),this},_.prototype.setFields=function(e){this.setParameter(y.FIELDS,A(e))},_.prototype.getFields=function(){return this.getParameter(y.FIELDS)},_.prototype.addField=function(e){var t=this.getFields()||[];t.push(e),this.setFields(t)},_.prototype.removeField=function(e){var t=this.getFields()||[],r=t.indexOf(e);0<=r&&(t.splice(r,1),this.setFields(t))},_.prototype.page=function(e){return this.setPage(e),this},_.prototype.setPage=function(e){isNaN(e)||1*e<0||this.setParameter(y.PAGE,1*e)},_.prototype.getPage=function(){return this.getParameter(y.PAGE)},_.prototype.nextPage=function(){this.setPage(this.getPage()+1)},_.prototype.previousPage=function(){this.setPage(this.getPage()-1)},_.prototype.pageSize=function(e){return this.setPageSize(e),this},_.prototype.setPageSize=function(e){isNaN(e)||1*e<0||this.setParameter(y.PAGE_SIZE,1*e)},_.prototype.getPageSize=function(){return this.getParameter(y.PAGE_SIZE)},_.prototype.sort=function(e,t){return this.setSort(e,t),this},_.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.setParameter(y.SORT,e)},_.prototype.getSort=function(){return this.getParameter(y.SORT)},_.prototype.getSortField=function(){var e=this.getSort();return e&&e.length?e.split(",")[0]:null},_.prototype.getSortOrder=function(){var e=this.getSort();return e&&e.length?e.split(",")[1]:null},_.prototype.getSortOptions=function(){return b.slice(0)},_.prototype.clear=function(){this.query=JSON.parse(JSON.stringify(this.defaultQuery))},_);function _(e){this.defaultQuery={},this.defaultQuery[y.PAGE.toString()]=0,this.defaultQuery[y.PAGE_SIZE.toString()]=10,this.defaultQuery[y.SORT.toString()]="modified,desc",this.defaultQuery[y.FIELDS.toString()]=T.slice(0),this.defaultQuery[y.FACETS.toString()]=I.slice(0),e&&e.defaults&&(Object.assign(this.defaultQuery,e.defaults),delete e.defaults),this.query=JSON.parse(JSON.stringify(this.defaultQuery)),e&&this.applyParameters(e)}var D={ualUrl:"https://ual.geoplatform.gov",configure:function(e){Object.assign(this,e)}},L=(U.prototype.setTimeout=function(e){this.timeout=e},U.prototype.setAuthToken=function(e){e&&"string"==typeof e?this.token=function(){return e}:e&&"function"==typeof e&&(this.token=e)},U.prototype.createRequestOpts=function(e){throw new Error("Must implement 'createRequestOpts' in a sub-class")},U.prototype.execute=function(e){return u.reject(new Error("Must overrdie 'execute' in a sub-class"))},U);function U(e){this.timeout=5e3,e=e||{},this.setTimeout(e.timeout||3e4),this.setAuthToken(e.token)}var w,N=(t(M,w=L),M.prototype.createRequestOpts=function(e){var t={method:e.method,url:e.url,timeout:e.timeout||this.timeout};if(!0===e.json&&(t.responseType="json"),e.params&&(t.params=e.params),e.data&&(t.data=e.data,t.contentType="application/json"),this.token){var r=this.token();r&&(t.headers=t.headers||{},t.headers.Authorization="Bearer "+r,t.withCredentials=!0)}if(e.options)for(var i in e.options)e.options.hasOwnProperty(i)&&(t[i]=e.options[i]);return t},M.prototype.execute=function(e){if(void 0===r)throw new Error("Axios not found, check that you have included it as a dependency of the application or use a different HttpClient implementation");var t=r(e).then(function(e){return e.data})["catch"](function(e){var t=new s(e.message);return e.response&&(t=new s(e.response.data)),u.reject(t)});return u.resolve(t)},M);function M(e){return w.call(this,e)||this}var B=(q.prototype.setUrl=function(e){this.apiBase=e,this.baseUrl=e+"/api/items"},q.prototype.setTimeout=function(e){this._timeout=e},q.prototype.timeout=function(e){return this.setTimeout(e),this},q.prototype.getClient=function(){return this.client},q.prototype.setLogger=function(e){this.logger=e},q.prototype.logError=function(e){this.logger&&this.logger.error&&this.logger.error(e)},q.prototype.logDebug=function(e){this.logger&&this.logger.debug&&this.logger.debug(e)},q.prototype.get=function(r,i){var o=this,e=this.baseUrl+"/"+r;return i&&i.version&&(e+="/versions/"+i.version),u.resolve(e).then(function(e){var t=o.buildRequest({method:"GET",url:e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("Error fetching item "+r+": "+e.message);return Object.assign(t,e),o.logError("ItemService.get() - "+t.message),u.reject(t)})},q.prototype.save=function(e,s){var n=this;return u.resolve(e).then(function(r){var i="POST",o=n.baseUrl;if(r.id)i="PUT",o+="/"+r.id;else if(!r.uri)return n.getUri(r,s).then(function(e){r.uri=e;var t=n.buildRequest({method:i,url:o,data:r,options:s});return n.execute(t)});var e=n.buildRequest({method:i,url:o,data:r,options:s});return n.execute(e)})["catch"](function(e){var t=new Error("Error saving item: "+e.message);return Object.assign(t,e),n.logError("ItemService.save() - "+t.message),u.reject(t)})},q.prototype.remove=function(r,i){var o=this;return u.resolve(this.baseUrl+"/"+r).then(function(e){var t=o.buildRequest({method:"DELETE",url:e,options:i});return o.execute(t)}).then(function(){return!0})["catch"](function(e){var t=new Error("Error deleting item "+r+": "+e.message);return Object.assign(t,e),o.logError("ItemService.remove() - "+t.message),u.reject(t)})},q.prototype.patch=function(r,i,o){var s=this;return u.resolve(this.baseUrl+"/"+r).then(function(e){var t=s.buildRequest({method:"PATCH",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error patching item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.patch() - "+t.message),u.reject(t)})},q.prototype.clone=function(r,i,o){var s=this;return u.resolve(this.baseUrl+"/"+r+"/clone").then(function(e){var t=s.buildRequest({method:"POST",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error cloning item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.clone() - "+t.message),u.reject(t)})},q.prototype.search=function(e,i){var o=this;return u.resolve(e).then(function(e){var t={};t=e&&"function"==typeof e.getQuery?e.getQuery():"object"==typeof e?e:{};var r=o.buildRequest({method:"GET",url:o.baseUrl,params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error searching items: "+e.message);return Object.assign(t,e),o.logError("ItemService.search() - "+t.message),u.reject(t)})},q.prototype["import"]=function(i,o,s){var n=this;return u.resolve(!0).then(function(){if(null===i||i===undefined)throw new Error("Must provide a valid URL or File");var e="string"!=typeof i,t={method:"POST",url:n.apiBase+"/api/import",processData:!0,formData:!0,options:s};e?(t.file=i,t.data={format:o}):(t.formData=!1,t.data={url:i,format:o}),s&&s.overwrite&&(t.data.overwrite=!!s.overwrite+"",delete s.overwrite);var r=n.buildRequest(t);return n.execute(r)})["catch"](function(e){var t=new Error("Error importing item: "+e.message);return Object.assign(t,e),409!==e.status&&!~e.message.indexOf("Item already exists")||Object.assign(t,{status:409}),e.item&&Object.assign(t,{item:e.item}),n.logError("ItemService.import() - "+t.message),u.reject(t)})},q.prototype["export"]=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=s.baseUrl+"/"+r+"/export",t=s.buildRequest({method:"GET",url:e,params:{format:i},json:!1,options:o});return s.execute(t)})["catch"](function(e){var t=e.message;(e.statusCode&&406===e.statusCode||"406"===e.statusCode)&&(t="Unsupported export format specified '"+i+"'");var r=new Error("Error exporting item: "+t);return Object.assign(r,e),s.logError("ItemService.export() - "+r.message),u.reject(r)})},q.prototype.getUri=function(e,i){var o=this;return u.resolve(e).then(function(e){if(!e||!e.type)throw new Error("Must provide an object with a type property");var t=o.apiBase+"/api/utils/uri";(i=i||{}).responseType="text";var r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error getting URI for item: "+e.message);return Object.assign(t,e),o.logError("ItemService.getUri() - "+t.message),u.reject(t)})},q.prototype.getMultiple=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.apiBase+"/api/fetch",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error fetching items: "+e.message);return Object.assign(t,e),o.logError("ItemService.getMultiple() - "+t.message),u.reject(t)})},q.prototype.exists=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.apiBase+"/api/utils/exists",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error resolving items: "+e.message);return Object.assign(t,e),o.logError("ItemService.exists() - "+t.message),u.reject(t)})},q.prototype.like=function(r,i){var o=this;return u.resolve(r.id).then(function(e){var t=o.apiBase+"/api/items/"+e+"/likes",r=o.buildRequest({method:"PUT",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error liking item "+r.id+": "+e.message);return Object.assign(t,e),o.logError("ItemService.like() - "+t.message),u.reject(t)})},q.prototype.view=function(r,i){var o=this;return u.resolve(r.id).then(function(e){var t=o.apiBase+"/api/items/"+e+"/views",r=o.buildRequest({method:"PUT",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error incrementing views for item "+r.id+": "+e.message);return Object.assign(t,e),o.logError("ItemService.like() - "+t.message),u.reject(t)})},q.prototype.associations=function(r,i,o){var s=this;return u.resolve(r).then(function(e){var t=s.baseUrl+"/"+e+"/associations",r=s.buildRequest({method:"GET",url:t,params:i||{},options:o});return s.execute(r)})["catch"](function(e){var t=new Error("Error fetching associations for item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.associations() - "+t.message),u.reject(t)})},q.prototype.versions=function(r,i,o){var s=this;return u.resolve(r).then(function(e){var t=s.baseUrl+"/"+e+"/versions",r=s.buildRequest({method:"GET",url:t,params:i,options:o});return s.execute(r)})["catch"](function(e){var t=new Error("Error fetching versions for item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.versions() - "+t.message),u.reject(t)})},q.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this._timeout||3e4,this.createRequestOpts(e)},q.prototype.createRequestOpts=function(e){var t=this.client.createRequestOpts(e);return this.logDebug("ItemService.createRequestOpts() - "+JSON.stringify(t)),t},q.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("ItemService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},q);function q(e,t){this._timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t}var x,j=(t(Y,x=B),Y.prototype.setUrl=function(e){x.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/datasets"},Y);function Y(e,t){return x.call(this,e,t)||this}var F,G=(t(H,F=B),H.prototype.setUrl=function(e){F.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/maps"},H);function H(e,t){return F.call(this,e,t)||this}var Q,k=(t(V,Q=B),V.prototype.setUrl=function(e){Q.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/layers"},V.prototype.style=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/style",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error fetching style: "+e.message);return Object.assign(t,e),o.logError("LayerService.style() - "+t.message),u.reject(t)})},V.prototype.describe=function(s,e,n){var a=this;return u.resolve(e).then(function(t){if(!t)throw new Error("Must provide describe parameters to use");var e=["bbox","height","width","x","y"].find(function(e){return!t[e]});if(e)throw new Error("Must specify "+e+" in describe req");var r={srs:"EPSG:4326",bbox:t.bbox,height:t.height,width:t.width,info_format:"text/xml",x:t.x,y:t.y,i:t.x,j:t.y},i=a.baseUrl+"/"+s+"/describe",o=a.buildRequest({method:"GET",url:i,params:r,options:n});return a.execute(o)})["catch"](function(e){var t=new Error("Error describing layer feature: "+e.message);return Object.assign(t,e),a.logError("LayerService.describe() - "+t.message),u.reject(t)})},V.prototype.validate=function(i,e,o){var s=this;return u.resolve(e).then(function(e){if(!e)throw new Error("Must provide parameters to use in layer validation");var t=s.baseUrl+"/"+i+"/validate",r=s.buildRequest({method:"GET",url:t,params:e,options:o});return s.execute(r)})["catch"](function(e){var t=new Error("Error validating layer request: "+e.message);return Object.assign(t,e),s.logError("LayerService.describe() - "+t.message),u.reject(t)})},V);function V(e,t){return Q.call(this,e,t)||this}var z,W=(t(K,z=B),K.prototype.setUrl=function(e){z.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/services"},K.prototype.about=function(e,r){var i=this;return u.resolve(e).then(function(e){if(!e)throw new Error("Must provide service to get metadata about");var t=i.buildRequest({method:"POST",url:i.baseUrl+"/about",data:e,options:r});return i.execute(t)})["catch"](function(e){var t=new Error("Error describing service: "+e.message);return Object.assign(t,e),i.logError("ServiceService.about() - "+t.message),u.reject(t)})},K.prototype.types=function(i){var o=this,e=(new C).types(a.STANDARD).resourceTypes("ServiceType").pageSize(50).getQuery();return u.resolve(e).then(function(e){var t=o.apiBase+"/api/items",r=o.buildRequest({method:"GET",url:t,params:e,options:i});return o.execute(r)}).then(function(e){return e.results})["catch"](function(e){var t=new Error("Error fetching service types: "+e.message);return Object.assign(t,e),o.logError("ServiceService.types() - "+t.message),u.reject(t)})},K.prototype["import"]=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/import",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error importing service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.import() - "+t.message),u.reject(t)})},K.prototype.harvest=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/harvest",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error harvesting layers from service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.harvest() - "+t.message),u.reject(t)})},K.prototype.liveTest=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/test",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error testing service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.liveTest() - "+t.message),u.reject(t)})},K.prototype.statistics=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/statistics",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error getting service statistics: "+e.message);return Object.assign(t,e),o.logError("ServiceService.statistics() - "+t.message),u.reject(t)})},K);function K(e,t){return z.call(this,e,t)||this}var Z,J=(t(X,Z=B),X.prototype.setUrl=function(e){Z.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/galleries"},X.prototype.addItem=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=s.baseUrl+"/"+r+"/items",t=s.buildRequest({method:"POST",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error adding item: "+e.message);return Object.assign(t,e),s.logError("GalleryService.addItem() - "+t.message),u.reject(t)})},X.prototype.removeItem=function(e,t,r){var i=this;return u.resolve(this.baseUrl+"/"+e+"/items/"+t).then(function(e){var t=i.buildRequest({method:"DELETE",url:e,options:r});return i.execute(t)}).then(function(){return!0})["catch"](function(e){var t=new Error("Error adding item: "+e.message);return Object.assign(t,e),i.logError("GalleryService.addItem() - "+t.message),u.reject(t)})},X);function X(e,t){return Z.call(this,e,t)||this}var $=(ee.prototype.setUrl=function(e){this.baseUrl=e},ee.prototype.setLogger=function(e){this.logger=e},ee.prototype.logError=function(e){this.logger&&this.logger.error&&this.logger.error(e)},ee.prototype.logDebug=function(e){this.logger&&this.logger.debug&&this.logger.debug(e)},ee.prototype.capabilities=function(e,r,i){var o=this,t=this.baseUrl+"/api/capabilities";return e&&(t+="/"+e),u.resolve(t).then(function(e){var t=o.buildRequest({method:"GET",url:e,params:r||{},options:i});return o.execute(t)})["catch"](function(e){var t=new Error("Error getting capabilities: "+e.message);return Object.assign(t,e),o.logError("UtilsService.capabilities() - "+t.message),u.reject(t)})},ee.prototype.parseFile=function(r,i,o){var s=this,e=this.baseUrl+"/api/utils/parse";return u.resolve(e).then(function(e){var t=s.buildRequest({method:"POST",url:e,data:{format:i},file:r,formData:!0,options:o});return s.execute(t)}).then(function(e){return e})["catch"](function(e){var t=new Error("Error parsing file: "+e.message);return Object.assign(t,e),s.logError("UtilsService.parseFile() - "+t.message),u.reject(t)})},ee.prototype.locate=function(r,i){var o=this,e=this.baseUrl+"/api/utils/gazetteer";return u.resolve(e).then(function(e){var t=o.buildRequest({method:"GET",url:e,params:{location:r},options:i});return o.execute(t)}).then(function(e){return e})["catch"](function(e){var t=new Error("Error resolving location: "+e.message);return Object.assign(t,e),o.logError("UtilsService.locate() - "+t.message),u.reject(t)})},ee.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||D.timeout||3e4,this.createRequestOpts(e)},ee.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},ee.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("UtilsService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},ee);function ee(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.client=t,this.baseUrl=e,this.timeout=D.timeout||3e4}var te=(re.prototype.getQuery=function(){var e={};for(var t in this._query){var r=this._query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},re.prototype.q=function(e){return this.setQ(e),this},re.prototype.setQ=function(e){this._query.q=e},re.prototype.getQ=function(){return this._query.q},re.prototype.types=function(e){return this.setTypes(e),this},re.prototype.setTypes=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.types=t},re.prototype.getTypes=function(){return this._query.types},re.prototype.groups=function(e){return this.setGroups(e),this},re.prototype.setGroups=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.groups=t},re.prototype.getGroups=function(){return this._query.groups},re.prototype.orgs=function(e){return this.setOrgs(e),this},re.prototype.setOrgs=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.orgs=t},re.prototype.getOrgs=function(){return this._query.orgs},re.prototype.extent=function(e){return this.setExtent(e),this},re.prototype.setExtent=function(e){this._query.bbox=e},re.prototype.getExtent=function(){return this._query.bbox},re.prototype.sort=function(e,t){return this.setSort(e,t),this},re.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this._query.sort=e},re.prototype.getSort=function(){return this._query.sort},re.prototype.getSortField=function(){return this._query.sort.split(",")[0]},re.prototype.getSortOrder=function(){return"asc"===this._query.sort.split(",")[1]},re.prototype.page=function(e){return this.setPage(e),this},re.prototype.setPage=function(e){isNaN(e)||1*e<0||(this._query.page=1*e)},re.prototype.getPage=function(){return this._query.page},re.prototype.nextPage=function(){this.setPage(this._query.page+1)},re.prototype.previousPage=function(){this.setPage(this._query.page-1)},re.prototype.pageSize=function(e){return this.setPageSize(e),this},re.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this._query.size=1*e)},re.prototype.getPageSize=function(){return this._query.size},re);function re(){this._query={page:0,size:10}}var ie=(oe.prototype.setUrl=function(e){this.baseUrl=e+"/api/agol"},oe.prototype.getOrg=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/orgs/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getOrg() - Error fetching org "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.searchOrgs=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/orgs",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchOrgs() - Error searching orgs: "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.getGroup=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/groups/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getGroup() - Error fetching group "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.searchGroups=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/groups",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchGroups() - Error searching groups: "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.getItem=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/items/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getItem() - Error fetching item "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.searchItems=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/items",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchItems() - Error searching items: "+e.message);return Object.assign(t,e),u.reject(t)})},oe.prototype.getAgolId=function(e){if(!e)return null;if(!e.type)return null;if(a.ORGANIZATION===e.type||"Group"===e.type)return e.id;if(!e.identifiers||!e.identifiers.length)return null;var t=e.identifiers.filter(function(e){return~e.indexOf("agol:")});return t.length?t[0].replace("agol:",""):null},oe.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||D.timeout||3e4,this.createRequestOpts(e)},oe.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},oe.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("AGOLService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},oe);function oe(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t,this.timeout=3e4}var se={UNKNOWN:"Unknown Category",DATASET:"Dataset",SERVICE:"Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",CONTACT:"Contact",ORGANIZATION:"Organization",CONCEPT:"Concept",CONCEPT_SCHEME:"Concept Scheme",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",IMAGE_PRODUCT:"Image Product",RIGHTS_STATEMENT:"RightsStatement",KNOWLEDGE_GRAPH:"Knowledge Graph",USER:"User",COMMUNITY_POST:"Community Post",COMMUNITY_PAGE:"Community Page",APP_PAGE:"Application Page"},ne={ACCESSED:"Accessed",DISPLAYED:"Displayed",VIEWED:"Viewed",CREATED:"Created",EDITED:"Edited",DELETED:"Deleted",CLONED:"Cloned",ADDED:"Added",REMOVED:"Removed",EXPORTED:"Exported",IMPORTED:"Imported"};var ae=(ue.prototype.getCategory=function(){return this.category},ue.prototype.getType=function(){return this.type},ue.prototype.getItem=function(){return this.item},ue.prototype.setItem=function(e){this.item=e?e.id||e:null},ue.prototype.getRelated=function(){return this.related},ue.prototype.setRelated=function(e){this.related=e?e.id||e:null},ue);function ue(e,t,r,i){if(this.item=null,this.related=null,!e||!t)throw new Error("TrackingService Event - Must specific an event category and event type when constructing events");this.category=e,this.type=t,this.setItem(r),this.setRelated(i)}var ce=(pe.prototype.logEvent=function(e,t,r,i){console.log("EVENT ("+e+") - "+t+" : "+r)},pe.prototype.logSearch=function(e,t){console.log("Query : "+JSON.stringify(e)+" found "+t+" matches")},pe);function pe(){}var le=(he.prototype.setProvider=function(e){e&&(this.provider=e)},he.prototype.event=function(e){return this.logEvent(e),this},he.prototype.logEvent=function(e){var t=this;if(this.provider&&this.provider.logEvent&&e)if(Array.isArray(e))e.forEach(function(e){return t.logEvent(e)});else{var r=e;try{this.provider.logEvent(r.getCategory(),r.getType(),r.getItem(),r.getRelated())}catch(i){console.log("TrackingService.logEvent() - Error logging event ("+r.getCategory()+", "+r.getType()+", "+r.getItem()+") - "+i.message)}}},he.prototype.pageView=function(e,t){return this.logPageView(e,t),this},he.prototype.logPageView=function(e,t){this.logEvent(new ae(se.APP_PAGE,ne.VIEWED,e))},he.prototype.logSearch=function(e,t){this.provider.logSearch(e,t)},he);function he(e){this.provider=null,e&&"object"==typeof e&&Object.assign(this,e),this.provider||this.setProvider(new ce)}var fe=(Ee.prototype.setUrl=function(e){this.apiBase=e,this.baseUrl=e+"/api/recommender"},Ee.prototype.suggest=function(e,t){var r=this.baseUrl+"/suggest";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.suggest() - Error suggesting concepts: "+e.message);return Object.assign(t,e),u.reject(t)})},Ee.prototype.types=function(e,t){var r=this.baseUrl+"/types";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.types() - Error searching types: "+e.message);return Object.assign(t,e),u.reject(t)})},Ee.prototype.sources=function(e,t){var r=this.baseUrl+"/sources";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.sources() - Error searching sources: "+e.message);return Object.assign(t,e),u.reject(t)})},Ee.prototype._search=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=i.getQuery(),t=s.buildRequest({method:"GET",url:r,params:e,options:o});return s.execute(t)})},Ee.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||D.timeout||3e4,this.createRequestOpts(e)},Ee.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},Ee.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("KGService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},Ee);function Ee(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t}!function ye(){!function e(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},writable:!0,configurable:!0})}()}(),e.ClientVersion="0.3.0",e.GPError=s,e.ItemTypes=a,e.ItemTypeLabels=c,e.QueryParameters=y,e.QueryFacets=P,e.Query=C,e.QueryFactory=function ge(){return new C},e.QueryFields=S,e.KGQuery=m,e.KGClassifiers=v,e.AgolQuery=te,e.URIFactory=function me(t){if("function"!=typeof t)throw new Error("Must specify a MD5 function when using URIFactory");return function(e){return E.create(e,t)}},e.Config=D,e.GPHttpClient=L,e.XHRHttpClient=N,e.ItemService=B,e.DatasetService=j,e.MapService=G,e.LayerService=k,e.ServiceService=W,e.GalleryService=J,e.UtilsService=$,e.KGService=fe,e.ServiceFactory=function(e,t,r){var i="string"==typeof e?e:e&&e.type?e.type:null;if(!i)throw new Error("Must provide a type or object with a type specified");if(!t)throw new Error("Must provide a base url");if(!r)throw new Error("Must provide an http client to use to make requests");switch(i){case a.LAYER:return new k(t,r);case a.SERVICE:return new W(t,r);case a.MAP:return new G(t,r);case a.GALLERY:return new J(t,r);case a.DATASET:return new j(t,r);default:return new B(t,r)}},e.AgolService=ie,e.TrackingEvent=ae,e.TrackingService=le,e.TrackingCategories=se,e.TrackingTypes=ne,e.TrackingEventFactory=function de(r,e){var i=[];if(r&&e&&e.type)if(a.MAP===e.type){if(i.push(new ae(se.MAP,r,e)),ne.DISPLAYED===r&&(e.layers.forEach(function(e){if(e.layer){var t=de(r,e.layer).filter(function(e){return null!==e});t&&t.length&&(i=i.concat(t))}}),e.baseLayer)){var t=de(r,e.baseLayer).filter(function(e){return null!==e});t&&t.length&&(i=i.concat(t))}}else if(a.LAYER===e.type)i.push(new ae(se.LAYER,r,e)),ne.DISPLAYED===r&&e.services&&e.services.length&&i.push(new ae(se.SERVICE,r,e.services[0]));else{var o=function s(e){var t=se.UNKNOWN;if(e){var r=Object.keys(se).map(function(e){return se[e]});if(~r.indexOf(e))return e;if(~e.indexOf(":")){var i=e.split(":")[1];if(~r.indexOf(i))return i}}return t}(e.type);i.push(new ae(o,r,e))}return i},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=geoplatform-client.umd.min.js.map