import { LayerService } from "@geoplatform/client";
import ServiceProxy from "./base";
var ɵ0 = function (svc, req) {
    return svc.search(req.query);
}, ɵ1 = function (svc, req) {
    return svc.get(req.params.id);
}, ɵ2 = function (svc, req) {
    return svc.save(req.body);
}, ɵ3 = function (svc, req) {
    return svc.save(req.body);
}, ɵ4 = function (svc, req) {
    return svc.remove(req.params.id);
}, ɵ5 = function (
// @ts-ignore
result, res) { res.status(204).end(); }, ɵ6 = function (svc, req) {
    return svc.patch(req.params.id, req.body);
}, ɵ7 = function (svc, req) {
    return svc.export(req.params.id, req.query.format);
}, ɵ8 = function (result, res) {
    var mimeType = result.headers['content-type'];
    var disposition = result.headers['content-disposition'];
    res.set("Content-Type", mimeType);
    res.setHeader('Content-disposition', disposition);
    res.send(result.body);
}, ɵ9 = function (svc, req) {
    return svc.style(req.params.id);
}, ɵ10 = function (svc, req) {
    return svc.style(req.params.id, req.params.styleId);
}, ɵ11 = function (svc, req) {
    return svc.styles(req.params.id);
}, ɵ12 = function (svc, req) {
    return svc.describe(req.params.id, req.body);
}, ɵ13 = function (svc, req) {
    return svc.validate(req.params.id, req.body);
};
var Routes = [
    {
        key: 'search',
        method: 'get',
        path: 'layers',
        auth: false,
        onExecute: ɵ0
    },
    {
        key: 'get',
        method: 'get',
        path: 'layers/:id',
        auth: false,
        onExecute: ɵ1
    },
    {
        key: 'create',
        method: 'post',
        path: 'layers',
        auth: true,
        onExecute: ɵ2
    },
    {
        key: 'update',
        method: 'put',
        path: 'layers/:id',
        auth: true,
        onExecute: ɵ3
    },
    {
        key: 'delete',
        method: 'delete',
        path: 'layers/:id',
        auth: true,
        onExecute: ɵ4,
        onResponse: ɵ5
    },
    {
        key: 'patch',
        method: 'patch',
        path: 'layers/:id',
        auth: true,
        onExecute: ɵ6
    },
    {
        key: 'export',
        method: 'get',
        path: 'layers/:id/export',
        auth: false,
        onExecute: ɵ7,
        onResponse: ɵ8
    },
    {
        key: 'style',
        method: 'get',
        path: 'layers/:id/style',
        auth: false,
        onExecute: ɵ9
    },
    {
        key: 'styleById',
        method: 'get',
        path: 'layers/:id/styles/:styleId',
        auth: false,
        onExecute: ɵ10
    },
    {
        key: 'styles',
        method: 'get',
        path: 'layers/:id/styles',
        auth: false,
        onExecute: ɵ11
    },
    {
        key: 'describe',
        method: 'post',
        path: 'layers/:id/describe',
        auth: false,
        onExecute: ɵ12
    },
    {
        key: 'validate',
        method: 'post',
        path: 'layers/:id/validate',
        auth: false,
        onExecute: ɵ13
    }
];
/**
 *
 */
function LayerServiceProxy(options) {
    if (typeof (options) === 'undefined') {
        options = {};
    }
    ;
    var router = options.router;
    if (!options.router) {
        var express = require('express');
        if (!express) {
            throw new Error("LayerServiceProxy() - Must provide" +
                "'options.router' or include express as a dependency");
        }
        router = express.Router();
    }
    if (!router)
        throw new Error("LayerServiceProxy() - " +
            "Unable to create proxy route, missing router");
    options.serviceClass = LayerService;
    ServiceProxy.bindRoutes(router, Routes, options);
    return router;
}
export default LayerServiceProxy;
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8, ɵ9, ɵ10, ɵ11, ɵ12, ɵ13 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5ZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ2VvcGxhdGZvcm0vY2xpZW50L25vZGUvIiwic291cmNlcyI6WyJzZXJ2aWNlcy9wcm94aWVzL2xheWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRCxPQUFPLFlBQVksTUFBTSxRQUFRLENBQUM7U0FVZixVQUFTLEdBQWtCLEVBQUUsR0FBUztJQUM3QyxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2pDLENBQUMsT0FPVSxVQUFTLEdBQWtCLEVBQUUsR0FBUztJQUM3QyxPQUFPLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNsQyxDQUFDLE9BT1UsVUFBUyxHQUFrQixFQUFFLEdBQVM7SUFDN0MsT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM5QixDQUFDLE9BT1UsVUFBUyxHQUFrQixFQUFFLEdBQVM7SUFDN0MsT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM5QixDQUFDLE9BT1UsVUFBUyxHQUFrQixFQUFFLEdBQVM7SUFDN0MsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDckMsQ0FBQyxPQUNXO0FBQ1IsYUFBYTtBQUNiLE1BQVksRUFDWixHQUFTLElBQUksR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FPOUIsVUFBUyxHQUFrQixFQUFFLEdBQVM7SUFDN0MsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxJQUFJ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QUMsb0NBQW9DO2dCQUNoRCxxREFBcUQsQ0FBQyxDQUFDO1NBQzlEO1FBQ0QsTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztLQUM3QjtJQUVELElBQUcsQ0FBQyxNQUFNO1FBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyx3QkFBd0I7WUFDaEQsOENBQThDLENBQUMsQ0FBQztJQUVwRCxPQUFPLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztJQUNwQyxZQUFZLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFFakQsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQztBQUVELGVBQWUsaUJBQWlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuaW1wb3J0IHtMYXllclNlcnZpY2V9IGZyb20gXCJAZ2VvcGxhdGZvcm0vY2xpZW50XCI7XG5pbXBvcnQgU2VydmljZVByb3h5IGZyb20gXCIuL2Jhc2VcIjtcblxuXG5cbmNvbnN0IFJvdXRlcyA9IFtcbiAgICB7XG4gICAgICAgIGtleSAgIDogJ3NlYXJjaCcsXG4gICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgIHBhdGggIDogJ2xheWVycycsXG4gICAgICAgIGF1dGggIDogZmFsc2UsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMuc2VhcmNoKHJlcS5xdWVyeSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAga2V5ICAgOiAnZ2V0JyxcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZCcsXG4gICAgICAgIGF1dGggIDogZmFsc2UsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMuZ2V0KHJlcS5wYXJhbXMuaWQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleSAgIDogJ2NyZWF0ZScsXG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBwYXRoICA6ICdsYXllcnMnLFxuICAgICAgICBhdXRoICA6IHRydWUsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMuc2F2ZShyZXEuYm9keSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAga2V5ICAgOiAndXBkYXRlJyxcbiAgICAgICAgbWV0aG9kOiAncHV0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZCcsXG4gICAgICAgIGF1dGggIDogdHJ1ZSxcbiAgICAgICAgb25FeGVjdXRlOiBmdW5jdGlvbihzdmMgOiBMYXllclNlcnZpY2UsIHJlcSA6IGFueSkge1xuICAgICAgICAgICAgcmV0dXJuIHN2Yy5zYXZlKHJlcS5ib2R5KTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXkgICA6ICdkZWxldGUnLFxuICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICBwYXRoICA6ICdsYXllcnMvOmlkJyxcbiAgICAgICAgYXV0aCAgOiB0cnVlLFxuICAgICAgICBvbkV4ZWN1dGU6IGZ1bmN0aW9uKHN2YyA6IExheWVyU2VydmljZSwgcmVxIDogYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gc3ZjLnJlbW92ZShyZXEucGFyYW1zLmlkKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZXNwb25zZTogZnVuY3Rpb24oXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICByZXN1bHQgOiBhbnksXG4gICAgICAgICAgICByZXMgOiBhbnkpIHsgcmVzLnN0YXR1cygyMDQpLmVuZCgpOyB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleSAgIDogJ3BhdGNoJyxcbiAgICAgICAgbWV0aG9kOiAncGF0Y2gnLFxuICAgICAgICBwYXRoICA6ICdsYXllcnMvOmlkJyxcbiAgICAgICAgYXV0aCAgOiB0cnVlLFxuICAgICAgICBvbkV4ZWN1dGU6IGZ1bmN0aW9uKHN2YyA6IExheWVyU2VydmljZSwgcmVxIDogYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gc3ZjLnBhdGNoKHJlcS5wYXJhbXMuaWQsIHJlcS5ib2R5KTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXkgICA6ICdleHBvcnQnLFxuICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICBwYXRoICA6ICdsYXllcnMvOmlkL2V4cG9ydCcsXG4gICAgICAgIGF1dGggIDogZmFsc2UsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMuZXhwb3J0KHJlcS5wYXJhbXMuaWQsIHJlcS5xdWVyeS5mb3JtYXQpOyB9XG4gICAgICAgICAgICAsXG4gICAgICAgIG9uUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3VsdCA6IGFueSwgcmVzIDogYW55KSB7XG4gICAgICAgICAgICBsZXQgbWltZVR5cGUgPSByZXN1bHQuaGVhZGVyc1snY29udGVudC10eXBlJ107XG4gICAgICAgICAgICBsZXQgZGlzcG9zaXRpb24gPSByZXN1bHQuaGVhZGVyc1snY29udGVudC1kaXNwb3NpdGlvbiddO1xuICAgICAgICAgICAgcmVzLnNldChcIkNvbnRlbnQtVHlwZVwiLCBtaW1lVHlwZSk7XG4gICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LWRpc3Bvc2l0aW9uJywgZGlzcG9zaXRpb24pO1xuICAgICAgICAgICAgcmVzLnNlbmQocmVzdWx0LmJvZHkpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGtleSAgIDogJ3N0eWxlJyxcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZC9zdHlsZScsXG4gICAgICAgIGF1dGggIDogZmFsc2UsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMuc3R5bGUocmVxLnBhcmFtcy5pZCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAga2V5ICAgOiAnc3R5bGVCeUlkJyxcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZC9zdHlsZXMvOnN0eWxlSWQnLFxuICAgICAgICBhdXRoICA6IGZhbHNlLFxuICAgICAgICBvbkV4ZWN1dGU6IGZ1bmN0aW9uKHN2YyA6IExheWVyU2VydmljZSwgcmVxIDogYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gc3ZjLnN0eWxlKHJlcS5wYXJhbXMuaWQsIHJlcS5wYXJhbXMuc3R5bGVJZCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAga2V5ICAgOiAnc3R5bGVzJyxcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZC9zdHlsZXMnLFxuICAgICAgICBhdXRoICA6IGZhbHNlLFxuICAgICAgICBvbkV4ZWN1dGU6IGZ1bmN0aW9uKHN2YyA6IExheWVyU2VydmljZSwgcmVxIDogYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gc3ZjLnN0eWxlcyhyZXEucGFyYW1zLmlkKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXkgICA6ICdkZXNjcmliZScsXG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBwYXRoICA6ICdsYXllcnMvOmlkL2Rlc2NyaWJlJyxcbiAgICAgICAgYXV0aCAgOiBmYWxzZSxcbiAgICAgICAgb25FeGVjdXRlOiBmdW5jdGlvbihzdmMgOiBMYXllclNlcnZpY2UsIHJlcSA6IGFueSkge1xuICAgICAgICAgICAgcmV0dXJuIHN2Yy5kZXNjcmliZShyZXEucGFyYW1zLmlkLCByZXEuYm9keSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAga2V5ICAgOiAndmFsaWRhdGUnLFxuICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgcGF0aCAgOiAnbGF5ZXJzLzppZC92YWxpZGF0ZScsXG4gICAgICAgIGF1dGggIDogZmFsc2UsXG4gICAgICAgIG9uRXhlY3V0ZTogZnVuY3Rpb24oc3ZjIDogTGF5ZXJTZXJ2aWNlLCByZXEgOiBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdmMudmFsaWRhdGUocmVxLnBhcmFtcy5pZCwgcmVxLmJvZHkpO1xuICAgICAgICB9XG4gICAgfVxuXTtcblxuXG5cbi8qKlxuICpcbiAqL1xuZnVuY3Rpb24gTGF5ZXJTZXJ2aWNlUHJveHkoIG9wdGlvbnMgPzogYW55ICkge1xuXG4gICAgaWYodHlwZW9mKG9wdGlvbnMpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBvcHRpb25zID0ge307XG4gICAgfTtcblxuICAgIGxldCByb3V0ZXIgPSBvcHRpb25zLnJvdXRlcjtcbiAgICBpZighb3B0aW9ucy5yb3V0ZXIpIHtcbiAgICAgICAgbGV0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG4gICAgICAgIGlmKCFleHByZXNzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMYXllclNlcnZpY2VQcm94eSgpIC0gTXVzdCBwcm92aWRlXCIgK1xuICAgICAgICAgICAgICAgIFwiJ29wdGlvbnMucm91dGVyJyBvciBpbmNsdWRlIGV4cHJlc3MgYXMgYSBkZXBlbmRlbmN5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG4gICAgfVxuXG4gICAgaWYoIXJvdXRlcikgdGhyb3cgbmV3IEVycm9yKFwiTGF5ZXJTZXJ2aWNlUHJveHkoKSAtIFwiICtcbiAgICAgICAgXCJVbmFibGUgdG8gY3JlYXRlIHByb3h5IHJvdXRlLCBtaXNzaW5nIHJvdXRlclwiKTtcblxuICAgIG9wdGlvbnMuc2VydmljZUNsYXNzID0gTGF5ZXJTZXJ2aWNlO1xuICAgIFNlcnZpY2VQcm94eS5iaW5kUm91dGVzKHJvdXRlciwgUm91dGVzLCBvcHRpb25zKTtcblxuICAgIHJldHVybiByb3V0ZXI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IExheWVyU2VydmljZVByb3h5O1xuIl19