/*
This software has been approved for release by the U.S. Department of the Interior. Although the software has been subjected to rigorous review, the DOI reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the DOI or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the DOI nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios"),require("q")):"function"==typeof define&&define.amd?define("@geoplatform/client",["exports","axios","q"],t):t((e.geoplatform=e.geoplatform||{},e.geoplatform.client={}),e.axios,e.Q)}(this,function(e,r,u){"use strict";r=r&&r.hasOwnProperty("default")?r["default"]:r;var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o,s=(t(n,o=Error),n.prototype.setError=function(e){this.error=e},n.prototype.setStatus=function(e){this.status=this.statusCode=e},n);function n(e){var t=o.call(this,e)||this;return t.status=500,t.statusCode=500,t.error=null,t}var a={DATASET:"dcat:Dataset",SERVICE:"regp:Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",ORGANIZATION:"org:Organization",CONTACT:"vcard:VCard",CONCEPT:"skos:Concept",CONCEPT_SCHEME:"skos:ConceptScheme",STANDARD:"dct:Standard",RIGHTS_STATEMENT:"dct:RightsStatement"},c={ALTERNATE_TITLE:"alternateTitles",BEGINS:"startDate.min",CREATED:"created",CREATED_BEFORE:"created.max",CREATED_AFTER:"created.min",CREATED_BY:"createdBy",CREATOR:"creator.id",CONTRIBUTED_BY:"contributedBy",ENDS:"endDate.max",EXTENT:"extent",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LAST_MODIFIED_BY:"lastModifiedBy",MODIFIED:"modified",MODIFIED_BEFORE:"modified.max",MODIFIED_AFTER:"modified.min",PUBLISHERS_ID:"publisher.id",PUBLISHERS_LABEL:"publisher.label",PUBLISHERS_URI:"publisher.uri",CONTACTS_ID:"contacts.id",CONTACTS_LABEL:"contacts.label",CONTACTS_URI:"contacts.uri",QUERY:"q",SCHEMES_ID:"scheme.id",SCHEMES_LABEL:"scheme.label",SCHEMES_URI:"scheme.uri",SIMILAR_TO:"similarTo",STATUS:"status",SERVICE_TYPES:"serviceType.id",THEMES_ID:"theme.id",THEMES_LABEL:"theme.label",THEMES_URI:"theme.uri",TOPICS_ID:"topic.id",TOPICS_LABEL:"topic.label",TOPICS_URI:"topic.uri",TYPES:"type",URI:"uri",USED_BY_ID:"usedBy.id",USED_BY_LABEL:"usedBy.label",USED_BY_URI:"usedBy.uri",VISIBILITY:"visibility",RESOURCE_TYPE:"resourceType",DATASET:"dataset",LANDING_PAGE:"landingPage",PURPOSE:"purpose",RELIABILITY:"reliability",RELIABILITY_MIN:"reliability.min",RELIABILITY_MAX:"reliability.max",ONLINE:"online",COMPLIANT:"compliant",SPEED:"speed",SPEED_MIN:"speed.min",SPEED_MAX:"speed.max",LIKES:"likes",LIKES_MIN:"likes.min",LIKES_MAX:"likes.max",VIEWS:"views",VIEWS_MIN:"views.min",VIEWS_MAX:"views.max",HREF:"href",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",PARENT_LAYER:"parentLayer",SUB_LAYER:"subLayer",SERVICE:"service",MAP_LAYER:"mapLayer",GALLERY_ITEM:"galleryItem",FACETS:"includeFacets",FIELDS:"fields",SORT:"sort",PAGE:"page",PAGE_SIZE:"size",FOR_TYPES:"for"},p=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],h=(l.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},l.prototype.parameter=function(e,t){return this.setParameter(e,t),this},l.prototype.setParameter=function(e,t){null===t||t===undefined?delete this.query[e]:this.query[e]=t},l.prototype.getParameter=function(e){return this.query[e]},l.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},l.prototype.q=function(e){return this.setQ(e),this},l.prototype.setQ=function(e){this.setParameter(c.QUERY,e)},l.prototype.getQ=function(){return this.getParameter(c.QUERY)},l.prototype.classifiers=function(e){return this.setClassifiers(e),this},l.prototype.setClassifiers=function(e){e&&("string"==typeof e&&(e=e=[e]),this.setParameter(c.TYPES,e))},l.prototype.getClassifiers=function(){return this.getParameter(c.TYPES)},l.prototype.types=function(e){return this.setTypes(e),this},l.prototype.setTypes=function(e){e&&("string"==typeof e&&(e=[e]),this.setParameter(c.FOR_TYPES,e))},l.prototype.getTypes=function(){return this.getParameter(c.FOR_TYPES)},l.prototype.page=function(e){return this.setPage(e),this},l.prototype.setPage=function(e){isNaN(e)||1*e<0||(this.query.page=1*e)},l.prototype.getPage=function(){return this.query.page},l.prototype.nextPage=function(){this.setPage(this.query.page+1)},l.prototype.previousPage=function(){this.setPage(this.query.page-1)},l.prototype.pageSize=function(e){return this.setPageSize(e),this},l.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this.query.size=1*e)},l.prototype.getPageSize=function(){return this.query.size},l.prototype.sort=function(e,t){return this.setSort(e,t),this},l.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.query.sort=e},l.prototype.getSort=function(){return this.query.sort},l.prototype.getSortField=function(){return this.query.sort.split(",")[0]},l.prototype.getSortOrder=function(){return"asc"===this.query.sort.split(",")[1]},l.prototype.getSortOptions=function(){return p.slice(0)},l.prototype.clear=function(){this.query=this.defaultQuery},l);function l(){this.defaultQuery={page:0,size:10,sort:"modified,desc"},this.query={page:0,size:10,sort:"modified,desc"}}var E={ACCESS_RIGHTS:"rights",ALTERNATE_TITLES:"alternateTitles",ANNOTATIONS:"annotations",CLASSIFIERS:"classifiers",CONCEPT_SCHEME:"scheme",CONTACTS:"contacts",CREATED:"created",CREATED_BY:"createdBy",DATASETS:"datasets",DESCRIPTION:"description",DISTRIBUTIONS:"distributions",EXTENT:"extent",GALLERY_ITEMS:"items",HREF:"href",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LABEL:"label",LAST_MODIFIED_BY:"lastModifiedBy",LAYERS:"layers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LEGEND:"legend",MODIFIED:"modified",PARENT_LAYER:"parentLayer",PUBLISHERS:"publishers",RESOURCE_TYPES:"resourceTypes",SERVICE_TYPE:"serviceType",SERVICES:"services",SPATIAL:"spatial",STATISTICS:"statistics",STATUS:"status",SUB_LAYERS:"subLayers",TEMPORAL:"temporal",THEMES:"themes",THUMBNAIL:"thumbnail",TOPICS:"topics",USED_BY:"usedBy",VISIBILITY:"visibility",LANDING_PAGE:"landingPage"},f=[E.CREATED,E.MODIFIED,E.CREATED_BY,E.PUBLISHERS,E.THEMES,E.DESCRIPTION],y={ALTERNATE_TITLES:"alternateTitles",CONCEPT_SCHEMES:"schemes",CREATED_BY:"createdBy",HREF:"href",IDENTIFIERS:"identifiers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LIKES:"likes",ONLINE:"online",PUBLISHERS:"publishers",CONTACTS:"contacts",RELIABILITY:"reliability",SERVICE_TYPES:"serviceTypes",SPEED:"speed",STATUS:"status",THEMES:"themes",TOPICS:"topics",TYPES:"type",USED_BY:"usedBy",VIEWS:"views",VISIBILITY:"visibility"},g=[y.TYPES,y.PUBLISHERS,y.SERVICE_TYPES,y.CONCEPT_SCHEMES,y.VISIBILITY,y.CREATED_BY],m={};m[y.TYPES]=c.TYPES,m[y.THEMES]=c.THEMES_ID,m[y.TOPICS]=c.TOPICS_ID,m[y.PUBLISHERS]=c.PUBLISHERS_ID,m[y.CONTACTS]=c.CONTACTS_ID,m[y.CONCEPT_SCHEMES]=c.SCHEMES_ID,m[y.USED_BY]=c.USED_BY_ID;var d=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],v=/^\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?$/;function S(e){var t=e;return null!==t&&"undefined"==typeof t.push&&(t=[t]),null===t||t.length||(t=null),t}var T=(P.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},P.prototype.clone=function(){var e=new P,t=JSON.parse(JSON.stringify(this.query));return e.applyParameters(t),e},P.prototype.parameter=function(e,t){return this.setParameter(e,t),this},P.prototype.setParameter=function(e,t){null===t||t===undefined||"undefined"!=typeof t.push&&!t.length?delete this.query[e]:this.query[e]=t},P.prototype.getParameter=function(e){return this.query[e]},P.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},P.prototype.setFacetParameter=function(e,t){var r=m[e];r||console.log("WARN : Query.applyFacetParameter() - unable to map facet to known parameter '"+e+"', using as direct parameter which may not operate as intended"),this.setParameter(r||e,t)},P.prototype.q=function(e){return this.setQ(e),this},P.prototype.setQ=function(e){this.setParameter(c.QUERY,e)},P.prototype.getQ=function(){return this.getParameter(c.QUERY)},P.prototype.keywords=function(e){return this.setKeywords(e),this},P.prototype.setKeywords=function(e){this.setParameter(c.KEYWORDS,S(e))},P.prototype.getKeywords=function(){return this.getParameter(c.KEYWORDS)},P.prototype.uri=function(e){return this.setUri(e),this},P.prototype.setUri=function(e){this.setParameter(c.URI,e)},P.prototype.getUri=function(){return this.getParameter(c.URI)},P.prototype.types=function(e){return this.setTypes(e),this},P.prototype.setTypes=function(e){this.setParameter(c.TYPES,S(e))},P.prototype.getTypes=function(){return this.getParameter(c.TYPES)},P.prototype.createdBy=function(e){return this.setCreatedBy(e),this},P.prototype.setCreatedBy=function(e){this.setParameter(c.CREATED_BY,e)},P.prototype.getCreatedBy=function(){return this.getParameter(c.CREATED_BY)},P.prototype.lastModifiedBy=function(e){return this.setLastModifiedBy(e),this},P.prototype.setLastModifiedBy=function(e){this.setParameter(c.LAST_MODIFIED_BY,e)},P.prototype.getLastModifiedBy=function(){return this.getParameter(c.LAST_MODIFIED_BY)},P.prototype.themes=function(e,t){return this.setThemes(e,t),this},P.prototype.setThemes=function(e,t){this.setParameter(c.THEMES_ID,null),this.setParameter(c.THEMES_LABEL,null),this.setParameter(c.THEMES_URI,null);var r=t||c.THEMES_ID;this.setParameter(r,S(e))},P.prototype.getThemes=function(){return this.getParameter(c.THEMES_ID)||this.getParameter(c.THEMES_LABEL)||this.getParameter(c.THEMES_URI)},P.prototype.topics=function(e,t){return this.setTopics(e,t),this},P.prototype.setTopics=function(e,t){this.setParameter(c.TOPICS_ID,null),this.setParameter(c.TOPICS_LABEL,null),this.setParameter(c.TOPICS_URI,null);var r=t||c.TOPICS_ID;this.setParameter(r,S(e))},P.prototype.getTopics=function(){return this.getParameter(c.TOPICS_ID)||this.getParameter(c.TOPICS_LABEL)||this.getParameter(c.TOPICS_URI)},P.prototype.publishers=function(e,t){return this.setPublishers(e,t),this},P.prototype.setPublishers=function(e,t){this.setParameter(c.PUBLISHERS_ID,null),this.setParameter(c.PUBLISHERS_LABEL,null),this.setParameter(c.PUBLISHERS_URI,null);var r=t||c.PUBLISHERS_ID;this.setParameter(r,S(e))},P.prototype.getPublishers=function(){return this.getParameter(c.PUBLISHERS_ID)||this.getParameter(c.PUBLISHERS_LABEL)||this.getParameter(c.PUBLISHERS_URI)},P.prototype.contacts=function(e,t){return this.setContacts(e,t),this},P.prototype.setContacts=function(e,t){this.setParameter(c.CONTACTS_ID,null),this.setParameter(c.CONTACTS_LABEL,null),this.setParameter(c.CONTACTS_URI,null);var r=t||c.CONTACTS_ID;this.setParameter(r,S(e))},P.prototype.getContacts=function(){return this.getParameter(c.CONTACTS_ID)||this.getParameter(c.CONTACTS_LABEL)||this.getParameter(c.CONTACTS_URI)},P.prototype.usedBy=function(e,t){return this.setUsedBy(e,t),this},P.prototype.setUsedBy=function(e,t){this.setParameter(c.USED_BY_ID,null),this.setParameter(c.USED_BY_LABEL,null),this.setParameter(c.USED_BY_URI,null);var r=t||c.USED_BY_ID;this.setParameter(r,S(e))},P.prototype.getUsedBy=function(){return this.getParameter(c.USED_BY_ID)||this.getParameter(c.USED_BY_LABEL)||this.getParameter(c.USED_BY_URI)},P.prototype.schemes=function(e,t){return this.setSchemes(e,t),this},P.prototype.setSchemes=function(e,t){this.setParameter(c.SCHEMES_ID,null),this.setParameter(c.SCHEMES_LABEL,null),this.setParameter(c.SCHEMES_URI,null);var r=t||c.SCHEMES_ID;this.setParameter(r,S(e))},P.prototype.getSchemes=function(){return this.getParameter(c.SCHEMES_ID)||this.getParameter(c.SCHEMES_LABEL)||this.getParameter(c.SCHEMES_URI)},P.prototype.serviceTypes=function(e){return this.setServiceTypes(e),this},P.prototype.setServiceTypes=function(e){this.setParameter(c.SERVICE_TYPES,S(e))},P.prototype.getServiceTypes=function(){return this.getParameter(c.SERVICE_TYPES)},P.prototype.visibility=function(e){return this.setVisibility(e),this},P.prototype.setVisibility=function(e){this.setParameter(c.VISIBILITY,e)},P.prototype.getVisibility=function(){return this.getParameter(c.VISIBILITY)},P.prototype.status=function(e){return this.setStatus(e),this},P.prototype.setStatus=function(e){this.setParameter(c.STATUS,e)},P.prototype.getStatus=function(){return this.getParameter(c.STATUS)},P.prototype.extent=function(e){return this.setExtent(e),this},P.prototype.setExtent=function(e){if(e)if("undefined"!=typeof e.toBboxString)e=e.toBboxString();else if("undefined"!=typeof e.push&&e.length&&"undefined"!=typeof e[0].push)e=e[0][1]+","+e[0][0]+","+e[1][1]+","+e[1][0];else{if("string"!=typeof e)throw new Error("Invalid argument: bbox must be one of Leaflet.Bounds, nested array, or bbox string");if(!v.test(e))throw new Error("Invalid argument: bbox string must be in form of 'minx,miny,maxx,maxy'")}this.setParameter(c.EXTENT,e)},P.prototype.getExtent=function(){return this.getParameter(c.EXTENT)},P.prototype.modified=function(e,t){return this.setModified(e,t),this},P.prototype.setModified=function(e,t){if(!e)return this.setParameter(c.MODIFIED_BEFORE,null),void this.setParameter(c.MODIFIED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?c.MODIFIED_BEFORE:c.MODIFIED_AFTER,o=r?c.MODIFIED_AFTER:c.MODIFIED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},P.prototype.getModified=function(){var e=this.getParameter(c.MODIFIED_BEFORE)||this.getParameter(c.MODIFIED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},P.prototype.created=function(e,t){return this.setCreated(e,t),this},P.prototype.setCreated=function(e,t){if(!e)return this.setParameter(c.CREATED_BEFORE,null),void this.setParameter(c.CREATED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?c.CREATED_BEFORE:c.CREATED_AFTER,o=r?c.CREATED_AFTER:c.CREATED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},P.prototype.getCreated=function(){var e=this.getParameter(c.CREATED_BEFORE)||this.getParameter(c.CREATED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},P.prototype.begins=function(e){return this.setBeginDate(e),this},P.prototype.setBeginDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(c.BEGINS,e)},P.prototype.getBeginDate=function(){var e=this.getParameter(c.BEGINS);return e&&(e=new Date(e)),e},P.prototype.ends=function(e){return this.setEndDate(e),this},P.prototype.setEndDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(c.ENDS,e)},P.prototype.getEndDate=function(){var e=this.getParameter(c.ENDS);return e&&(e=new Date(e)),e},P.prototype.between=function(e,t){return this.setBetween(e,t),this},P.prototype.setBetween=function(e,t){this.begins(e),this.ends(t)},P.prototype.resourceTypes=function(e){return this.setResourceTypes(e),this},P.prototype.setResourceTypes=function(e){this.setParameter(c.RESOURCE_TYPE,S(e))},P.prototype.getResourceTypes=function(){return this.getParameter(c.RESOURCE_TYPE)},P.prototype.facets=function(e){return this.setFacets(e),this},P.prototype.setFacets=function(e){this.setParameter(c.FACETS,S(e))},P.prototype.getFacets=function(){return this.getParameter(c.FACETS)},P.prototype.addFacet=function(e){var t=this.getFacets()||[];t.push(e),this.setFacets(t)},P.prototype.removeFacet=function(e){var t=this.getFacets()||[],r=t.indexOf(e);0<=r&&(t.splice(r,1),this.setFacets(t))},P.prototype.fields=function(e){return this.setFields(e),this},P.prototype.setFields=function(e){this.setParameter(c.FIELDS,S(e))},P.prototype.getFields=function(){return this.getParameter(c.FIELDS)},P.prototype.addField=function(e){var t=this.getFields()||[];t.push(e),this.setFields(t)},P.prototype.removeField=function(e){var t=this.getFields()||[],r=t.indexOf(e);0<=r&&(t.splice(r,1),this.setFields(t))},P.prototype.page=function(e){return this.setPage(e),this},P.prototype.setPage=function(e){isNaN(e)||1*e<0||this.setParameter(c.PAGE,1*e)},P.prototype.getPage=function(){return this.getParameter(c.PAGE)},P.prototype.nextPage=function(){this.setPage(this.getPage()+1)},P.prototype.previousPage=function(){this.setPage(this.getPage()-1)},P.prototype.pageSize=function(e){return this.setPageSize(e),this},P.prototype.setPageSize=function(e){isNaN(e)||1*e<0||this.setParameter(c.PAGE_SIZE,1*e)},P.prototype.getPageSize=function(){return this.getParameter(c.PAGE_SIZE)},P.prototype.sort=function(e,t){return this.setSort(e,t),this},P.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.setParameter(c.SORT,e)},P.prototype.getSort=function(){return this.getParameter(c.SORT)},P.prototype.getSortField=function(){var e=this.getSort();return e&&e.length?e.split(",")[0]:null},P.prototype.getSortOrder=function(){var e=this.getSort();return e&&e.length?e.split(",")[1]:null},P.prototype.getSortOptions=function(){return d.slice(0)},P.prototype.clear=function(){this.query=JSON.parse(JSON.stringify(this.defaultQuery))},P);function P(e){this.defaultQuery={},this.defaultQuery[c.PAGE.toString()]=0,this.defaultQuery[c.PAGE_SIZE.toString()]=10,this.defaultQuery[c.SORT.toString()]="modified,desc",this.defaultQuery[c.FIELDS.toString()]=f.slice(0),this.defaultQuery[c.FACETS.toString()]=g.slice(0),e&&e.defaults&&(Object.assign(this.defaultQuery,e.defaults),delete e.defaults),this.query=JSON.parse(JSON.stringify(this.defaultQuery)),e&&this.applyParameters(e)}var I={ualUrl:"https://ual.geoplatform.gov",configure:function(e){Object.assign(this,e)}},R=(b.prototype.setTimeout=function(e){this.timeout=e},b.prototype.setAuthToken=function(e){e&&"string"==typeof e?this.token=function(){return e}:e&&"function"==typeof e&&(this.token=e)},b.prototype.createRequestOpts=function(e){throw new Error("Must implement 'createRequestOpts' in a sub-class")},b.prototype.execute=function(e){return u.reject(new Error("Must overrdie 'execute' in a sub-class"))},b);function b(e){this.timeout=5e3,e=e||{},this.setTimeout(e.timeout||3e4),this.setAuthToken(e.token)}var O,A=(t(_,O=R),_.prototype.createRequestOpts=function(e){var t={method:e.method,url:e.url,timeout:e.timeout||this.timeout};if(!0===e.json&&(t.responseType="json"),e.params&&(t.params=e.params),e.data&&(t.data=e.data,t.contentType="application/json"),this.token){var r=this.token();r&&(t.headers=t.headers||{},t.headers.Authorization="Bearer "+r,t.withCredentials=!0)}if(e.options)for(var i in e.options)e.options.hasOwnProperty(i)&&(t[i]=e.options[i]);return t},_.prototype.execute=function(e){if(void 0===r)throw new Error("Axios not found, check that you have included it as a dependency of the application or use a different HttpClient implementation");var t=r(e).then(function(e){return e.data})["catch"](function(e){var t=new s(e.message);return e.response&&(t=new s(e.response.data)),u.reject(t)});return u.resolve(t)},_);function _(e){return O.call(this,e)||this}var C=(D.prototype.setUrl=function(e){this.apiBase=e,this.baseUrl=e+"/api/items"},D.prototype.setTimeout=function(e){this._timeout=e},D.prototype.timeout=function(e){return this.setTimeout(e),this},D.prototype.setLogger=function(e){this.logger=e},D.prototype.logError=function(e){this.logger&&this.logger.error&&this.logger.error(e)},D.prototype.logDebug=function(e){this.logger&&this.logger.debug&&this.logger.debug(e)},D.prototype.get=function(r,i){var o=this,e=this.baseUrl+"/"+r;return i&&i.version&&(e+="/versions/"+i.version),u.resolve(e).then(function(e){var t=o.buildRequest({method:"GET",url:e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("Error fetching item "+r+": "+e.message);return Object.assign(t,e),o.logError("ItemService.get() - "+t.message),u.reject(t)})},D.prototype.save=function(e,s){var n=this;return u.resolve(e).then(function(r){var i="POST",o=n.baseUrl;if(r.id)i="PUT",o+="/"+r.id;else if(!r.uri)return n.getUri(r,s).then(function(e){r.uri=e;var t=n.buildRequest({method:i,url:o,data:r,options:s});return n.execute(t)});var e=n.buildRequest({method:i,url:o,data:r,options:s});return n.execute(e)})["catch"](function(e){var t=new Error("Error saving item: "+e.message);return Object.assign(t,e),n.logError("ItemService.save() - "+t.message),u.reject(t)})},D.prototype.remove=function(r,i){var o=this;return u.resolve(this.baseUrl+"/"+r).then(function(e){var t=o.buildRequest({method:"DELETE",url:e,options:i});return o.execute(t)}).then(function(){return!0})["catch"](function(e){var t=new Error("Error deleting item "+r+": "+e.message);return Object.assign(t,e),o.logError("ItemService.remove() - "+t.message),u.reject(t)})},D.prototype.patch=function(r,i,o){var s=this;return u.resolve(this.baseUrl+"/"+r).then(function(e){var t=s.buildRequest({method:"PATCH",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error patching item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.patch() - "+t.message),u.reject(t)})},D.prototype.clone=function(r,i,o){var s=this;return u.resolve(this.baseUrl+"/"+r+"/clone").then(function(e){var t=s.buildRequest({method:"POST",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error cloning item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.clone() - "+t.message),u.reject(t)})},D.prototype.search=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e?e.getQuery():{},r=o.buildRequest({method:"GET",url:o.baseUrl,params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error searching items: "+e.message);return Object.assign(t,e),o.logError("ItemService.search() - "+t.message),u.reject(t)})},D.prototype["import"]=function(i,o,s){var n=this;return u.resolve(!0).then(function(){if(null===i||i===undefined)throw new Error("Must provide a valid URL or File");var e="string"!=typeof i,t={method:"POST",url:n.apiBase+"/api/import",processData:!0,formData:!0,options:s};e?(t.file=i,t.data={format:o}):(t.formData=!1,t.data={url:i,format:o}),s&&s.overwrite&&(t.data.overwrite=!!s.overwrite+"",delete s.overwrite);var r=n.buildRequest(t);return n.execute(r)})["catch"](function(e){var t=new Error("Error importing item: "+e.message);return Object.assign(t,e),409!==e.status&&!~e.message.indexOf("Item already exists")||Object.assign(t,{status:409}),e.item&&Object.assign(t,{item:e.item}),n.logError("ItemService.import() - "+t.message),u.reject(t)})},D.prototype["export"]=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=s.baseUrl+"/"+r+"/export",t=s.buildRequest({method:"GET",url:e,params:{format:i},json:!1,options:o});return s.execute(t)})["catch"](function(e){var t=e.message;(e.statusCode&&406===e.statusCode||"406"===e.statusCode)&&(t="Unsupported export format specified '"+i+"'");var r=new Error("Error exporting item: "+t);return Object.assign(r,e),s.logError("ItemService.export() - "+r.message),u.reject(r)})},D.prototype.getUri=function(e,i){var o=this;return u.resolve(e).then(function(e){if(!e||!e.type)throw new Error("Must provide an object with a type property");var t=o.apiBase+"/api/utils/uri";(i=i||{}).responseType="text";var r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error getting URI for item: "+e.message);return Object.assign(t,e),o.logError("ItemService.getUri() - "+t.message),u.reject(t)})},D.prototype.getMultiple=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.apiBase+"/api/fetch",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error fetching items: "+e.message);return Object.assign(t,e),o.logError("ItemService.getMultiple() - "+t.message),u.reject(t)})},D.prototype.exists=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.apiBase+"/api/utils/exists",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error resolving items: "+e.message);return Object.assign(t,e),o.logError("ItemService.exists() - "+t.message),u.reject(t)})},D.prototype.like=function(r,i){var o=this;return u.resolve(r.id).then(function(e){var t=o.apiBase+"/api/items/"+e+"/likes",r=o.buildRequest({method:"PUT",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error liking item "+r.id+": "+e.message);return Object.assign(t,e),o.logError("ItemService.like() - "+t.message),u.reject(t)})},D.prototype.view=function(r,i){var o=this;return u.resolve(r.id).then(function(e){var t=o.apiBase+"/api/items/"+e+"/views",r=o.buildRequest({method:"PUT",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error incrementing views for item "+r.id+": "+e.message);return Object.assign(t,e),o.logError("ItemService.like() - "+t.message),u.reject(t)})},D.prototype.associations=function(r,i,o){var s=this;return u.resolve(r).then(function(e){var t=s.baseUrl+"/"+e+"/associations",r=s.buildRequest({method:"GET",url:t,params:i||{},options:o});return s.execute(r)})["catch"](function(e){var t=new Error("Error fetching associations for item "+r+": "+e.message);return Object.assign(t,e),s.logError("ItemService.associations() - "+t.message),u.reject(t)})},D.prototype.versions=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.baseUrl+"/"+e+"/versions",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error fetching versions for item "+r+": "+e.message);return Object.assign(t,e),o.logError("ItemService.versions() - "+t.message),u.reject(t)})},D.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this._timeout||3e4,this.createRequestOpts(e)},D.prototype.createRequestOpts=function(e){var t=this.client.createRequestOpts(e);return this.logDebug("ItemService.createRequestOpts() - "+JSON.stringify(t)),t},D.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("ItemService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},D);function D(e,t){this._timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t}var U,L=(t(w,U=C),w.prototype.setUrl=function(e){U.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/datasets"},w);function w(e,t){return U.call(this,e,t)||this}var B,q=(t(M,B=C),M.prototype.setUrl=function(e){B.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/maps"},M);function M(e,t){return B.call(this,e,t)||this}var N,x=(t(j,N=C),j.prototype.setUrl=function(e){N.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/layers"},j.prototype.style=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/style",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error fetching style: "+e.message);return Object.assign(t,e),o.logError("LayerService.style() - "+t.message),u.reject(t)})},j.prototype.describe=function(s,e,n){var a=this;return u.resolve(e).then(function(t){if(!t)throw new Error("Must provide describe parameters to use");var e=["bbox","height","width","x","y"].find(function(e){return!t[e]});if(e)throw new Error("Must specify "+e+" in describe req");var r={srs:"EPSG:4326",bbox:t.bbox,height:t.height,width:t.width,info_format:"text/xml",x:t.x,y:t.y,i:t.x,j:t.y},i=a.baseUrl+"/"+s+"/describe",o=a.buildRequest({method:"GET",url:i,params:r,options:n});return a.execute(o)})["catch"](function(e){var t=new Error("Error describing layer feature: "+e.message);return Object.assign(t,e),a.logError("LayerService.describe() - "+t.message),u.reject(t)})},j.prototype.validate=function(i,e,o){var s=this;return u.resolve(e).then(function(e){if(!e)throw new Error("Must provide parameters to use in layer validation");var t=s.baseUrl+"/"+i+"/validate",r=s.buildRequest({method:"GET",url:t,params:e,options:o});return s.execute(r)})["catch"](function(e){var t=new Error("Error validating layer request: "+e.message);return Object.assign(t,e),s.logError("LayerService.describe() - "+t.message),u.reject(t)})},j);function j(e,t){return N.call(this,e,t)||this}var Y,F=(t(G,Y=C),G.prototype.setUrl=function(e){Y.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/services"},G.prototype.about=function(e,r){var i=this;return u.resolve(e).then(function(e){if(!e)throw new Error("Must provide service to get metadata about");var t=i.buildRequest({method:"POST",url:i.baseUrl+"/about",data:e,options:r});return i.execute(t)})["catch"](function(e){var t=new Error("Error describing service: "+e.message);return Object.assign(t,e),i.logError("ServiceService.about() - "+t.message),u.reject(t)})},G.prototype.types=function(i){var o=this,e=(new T).types(a.STANDARD).resourceTypes("ServiceType").pageSize(50).getQuery();return u.resolve(e).then(function(e){var t=o.apiBase+"/api/items",r=o.buildRequest({method:"GET",url:t,params:e,options:i});return o.execute(r)}).then(function(e){return e.results})["catch"](function(e){var t=new Error("Error fetching service types: "+e.message);return Object.assign(t,e),o.logError("ServiceService.types() - "+t.message),u.reject(t)})},G.prototype["import"]=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/import",r=o.buildRequest({method:"POST",url:t,data:e,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error importing service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.import() - "+t.message),u.reject(t)})},G.prototype.harvest=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/harvest",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error harvesting layers from service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.harvest() - "+t.message),u.reject(t)})},G.prototype.liveTest=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/test",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error testing service: "+e.message);return Object.assign(t,e),o.logError("ServiceService.liveTest() - "+t.message),u.reject(t)})},G.prototype.statistics=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=o.baseUrl+"/"+e+"/statistics",r=o.buildRequest({method:"GET",url:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("Error getting service statistics: "+e.message);return Object.assign(t,e),o.logError("ServiceService.statistics() - "+t.message),u.reject(t)})},G);function G(e,t){return Y.call(this,e,t)||this}var H,Q=(t(k,H=C),k.prototype.setUrl=function(e){H.prototype.setUrl.call(this,e),this.baseUrl=e+"/api/galleries"},k.prototype.addItem=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=s.baseUrl+"/"+r+"/items",t=s.buildRequest({method:"POST",url:e,data:i,options:o});return s.execute(t)})["catch"](function(e){var t=new Error("Error adding item: "+e.message);return Object.assign(t,e),s.logError("GalleryService.addItem() - "+t.message),u.reject(t)})},k.prototype.removeItem=function(e,t,r){var i=this;return u.resolve(this.baseUrl+"/"+e+"/items/"+t).then(function(e){var t=i.buildRequest({method:"DELETE",url:e,options:r});return i.execute(t)}).then(function(){return!0})["catch"](function(e){var t=new Error("Error adding item: "+e.message);return Object.assign(t,e),i.logError("GalleryService.addItem() - "+t.message),u.reject(t)})},k);function k(e,t){return H.call(this,e,t)||this}var V=(z.prototype.setUrl=function(e){this.baseUrl=e},z.prototype.setLogger=function(e){this.logger=e},z.prototype.logError=function(e){this.logger&&this.logger.error&&this.logger.error(e)},z.prototype.logDebug=function(e){this.logger&&this.logger.debug&&this.logger.debug(e)},z.prototype.capabilities=function(e,r,i){var o=this,t=this.baseUrl+"/api/capabilities";return e&&(t+="/"+e),u.resolve(t).then(function(e){var t=o.buildRequest({method:"GET",url:e,params:r||{},options:i});return o.execute(t)})["catch"](function(e){var t=new Error("Error getting capabilities: "+e.message);return Object.assign(t,e),o.logError("UtilsService.capabilities() - "+t.message),u.reject(t)})},z.prototype.parseFile=function(r,i,o){var s=this,e=this.baseUrl+"/api/utils/parse";return u.resolve(e).then(function(e){var t=s.buildRequest({method:"POST",url:e,data:{format:i},file:r,formData:!0,options:o});return s.execute(t)}).then(function(e){return e})["catch"](function(e){var t=new Error("Error parsing file: "+e.message);return Object.assign(t,e),s.logError("UtilsService.parseFile() - "+t.message),u.reject(t)})},z.prototype.locate=function(r,i){var o=this,e=this.baseUrl+"/api/utils/gazetteer";return u.resolve(e).then(function(e){var t=o.buildRequest({method:"GET",url:e,params:{location:r},options:i});return o.execute(t)}).then(function(e){return e})["catch"](function(e){var t=new Error("Error resolving location: "+e.message);return Object.assign(t,e),o.logError("UtilsService.locate() - "+t.message),u.reject(t)})},z.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||I.timeout||3e4,this.createRequestOpts(e)},z.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},z.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("UtilsService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},z);function z(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.client=t,this.baseUrl=e,this.timeout=I.timeout||3e4}var K=(W.prototype.getQuery=function(){var e={};for(var t in this._query){var r=this._query[t];null!==r&&"undefined"!=typeof r.push&&(r=r.join(",")),e[t]=r}return e},W.prototype.q=function(e){return this.setQ(e),this},W.prototype.setQ=function(e){this._query.q=e},W.prototype.getQ=function(){return this._query.q},W.prototype.types=function(e){return this.setTypes(e),this},W.prototype.setTypes=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.types=t},W.prototype.getTypes=function(){return this._query.types},W.prototype.groups=function(e){return this.setGroups(e),this},W.prototype.setGroups=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.groups=t},W.prototype.getGroups=function(){return this._query.groups},W.prototype.orgs=function(e){return this.setOrgs(e),this},W.prototype.setOrgs=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.orgs=t},W.prototype.getOrgs=function(){return this._query.orgs},W.prototype.extent=function(e){return this.setExtent(e),this},W.prototype.setExtent=function(e){this._query.bbox=e},W.prototype.getExtent=function(){return this._query.bbox},W.prototype.sort=function(e,t){return this.setSort(e,t),this},W.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this._query.sort=e},W.prototype.getSort=function(){return this._query.sort},W.prototype.getSortField=function(){return this._query.sort.split(",")[0]},W.prototype.getSortOrder=function(){return"asc"===this._query.sort.split(",")[1]},W.prototype.page=function(e){return this.setPage(e),this},W.prototype.setPage=function(e){isNaN(e)||1*e<0||(this._query.page=1*e)},W.prototype.getPage=function(){return this._query.page},W.prototype.nextPage=function(){this.setPage(this._query.page+1)},W.prototype.previousPage=function(){this.setPage(this._query.page-1)},W.prototype.pageSize=function(e){return this.setPageSize(e),this},W.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this._query.size=1*e)},W.prototype.getPageSize=function(){return this._query.size},W);function W(){this._query={page:0,size:10}}var Z=(J.prototype.setUrl=function(e){this.baseUrl=e+"/api/agol"},J.prototype.getOrg=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/orgs/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getOrg() - Error fetching org "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.searchOrgs=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/orgs",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchOrgs() - Error searching orgs: "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.getGroup=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/groups/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getGroup() - Error fetching group "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.searchGroups=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/groups",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchGroups() - Error searching groups: "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.getItem=function(r,i){var o=this;return u.resolve(r).then(function(e){var t=o.buildRequest({method:"GET",url:o.baseUrl+"/items/"+e,options:i});return o.execute(t)})["catch"](function(e){var t=new Error("AgolService.getItem() - Error fetching item "+r+": "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.searchItems=function(e,i){var o=this;return u.resolve(e).then(function(e){var t=e.getQuery(),r=o.buildRequest({method:"GET",url:o.baseUrl+"/items",params:t,options:i});return o.execute(r)})["catch"](function(e){var t=new Error("AgolService.searchItems() - Error searching items: "+e.message);return Object.assign(t,e),u.reject(t)})},J.prototype.getAgolId=function(e){if(!e)return null;if(!e.type)return null;if(a.ORGANIZATION===e.type||"Group"===e.type)return e.id;if(!e.identifiers||!e.identifiers.length)return null;var t=e.identifiers.filter(function(e){return~e.indexOf("agol:")});return t.length?t[0].replace("agol:",""):null},J.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||I.timeout||3e4,this.createRequestOpts(e)},J.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},J.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("AGOLService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},J);function J(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t,this.timeout=3e4}var X={UNKNOWN:"Unknown Category",DATASET:"Dataset",SERVICE:"Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",CONTACT:"Contact",ORGANIZATION:"Organization",CONCEPT:"Concept",CONCEPT_SCHEME:"Concept Scheme",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",RIGHTS_STATEMENT:"RightsStatement",KNOWLEDGE_GRAPH:"Knowledge Graph",USER:"User",COMMUNITY_POST:"Community Post",COMMUNITY_PAGE:"Community Page",APP_PAGE:"Application Page"},$={ACCESSED:"Accessed",DISPLAYED:"Displayed",VIEWED:"Viewed",CREATED:"Created",EDITED:"Edited",DELETED:"Deleted"};var ee=(te.prototype.getCategory=function(){return this.category},te.prototype.getType=function(){return this.type},te.prototype.getItem=function(){return this.item},te.prototype.setItem=function(e){this.item=e?e.id||e:null},te.prototype.getRelated=function(){return this.related},te.prototype.setRelated=function(e){this.related=e?e.id||e:null},te);function te(e,t,r,i){if(this.item=null,this.related=null,!e||!t)throw new Error("TrackingService Event - Must specific an event category and event type when constructing events");this.category=e,this.type=t,this.setItem(r),this.setRelated(i)}var re=(ie.prototype.logEvent=function(e,t,r,i){console.log("EVENT ("+e+") - "+t+" : "+r)},ie.prototype.logSearch=function(e,t){console.log("Query : "+JSON.stringify(e)+" found "+t+" matches")},ie);function ie(){}var oe=(se.prototype.setProvider=function(e){e&&(this.provider=e)},se.prototype.event=function(e){return this.logEvent(e),this},se.prototype.logEvent=function(e){var t=this;if(this.provider&&this.provider.logEvent&&e)if(Array.isArray(e))e.forEach(function(e){return t.logEvent(e)});else{var r=e;try{this.provider.logEvent(r.getCategory(),r.getType(),r.getItem(),r.getRelated())}catch(i){console.log("TrackingService.logEvent() - Error logging event ("+r.getCategory()+", "+r.getType()+", "+r.getItem()+") - "+i.message)}}},se.prototype.pageView=function(e,t){return this.logPageView(e,t),this},se.prototype.logPageView=function(e,t){this.logEvent(new ee(X.APP_PAGE,$.VIEWED,e))},se.prototype.logSearch=function(e,t){this.provider.logSearch(e,t)},se);function se(e){this.provider=null,e&&"object"==typeof e&&Object.assign(this,e),this.provider||this.setProvider(new re)}var ne=(ae.prototype.setUrl=function(e){this.apiBase=e,this.baseUrl=e+"/api/recommender"},ae.prototype.suggest=function(e,t){var r=this.baseUrl+"/suggest";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.suggest() - Error suggesting concepts: "+e.message);return Object.assign(t,e),u.reject(t)})},ae.prototype.types=function(e,t){var r=this.baseUrl+"/types";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.types() - Error searching types: "+e.message);return Object.assign(t,e),u.reject(t)})},ae.prototype.sources=function(e,t){var r=this.baseUrl+"/sources";return this._search(r,e,t)["catch"](function(e){var t=new Error("KGService.sources() - Error searching sources: "+e.message);return Object.assign(t,e),u.reject(t)})},ae.prototype._search=function(r,i,o){var s=this;return u.resolve(!0).then(function(){var e=i.getQuery(),t=s.buildRequest({method:"GET",url:r,params:e,options:o});return s.execute(t)})},ae.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this.timeout||I.timeout||3e4,this.createRequestOpts(e)},ae.prototype.createRequestOpts=function(e){return this.client.createRequestOpts(e)},ae.prototype.execute=function(e){return this.client.execute(e)["catch"](function(e){return null==e&&(e=new Error("KGService.execute() - Request failed but didn't return an error. This is most likely because the request timed out")),u.reject(e)})},ae);function ae(e,t){this.timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t}!function ue(){!function e(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},writable:!0,configurable:!0})}()}(),e.GPError=s,e.ItemTypes=a,e.QueryParameters=c,e.QueryFacets=y,e.Query=T,e.QueryFactory=function ce(){return new T},e.QueryFields=E,e.KGQuery=h,e.KGClassifiers={PURPOSE:"purpose",FUNCTION:"function",TOPIC_PRIMARY:"primaryTopic",TOPIC_SECONDARY:"secondaryTopic",SUBJECT_PRIMARY:"primarySubject",SUBJECT_SECONDARY:"secondarySubject",COMMUNITY:"community",AUDIENCE:"audience",PLACE:"place",CATEGORY:"category"},e.AgolQuery=K,e.Config=I,e.GPHttpClient=R,e.XHRHttpClient=A,e.ItemService=C,e.DatasetService=L,e.MapService=q,e.LayerService=x,e.ServiceService=F,e.GalleryService=Q,e.UtilsService=V,e.KGService=ne,e.ServiceFactory=function(e,t,r){var i="string"==typeof e?e:e&&e.type?e.type:null;if(!i)throw new Error("Must provide a type or object with a type specified");if(!t)throw new Error("Must provide a base url");if(!r)throw new Error("Must provide an http client to use to make requests");switch(i){case a.LAYER:return new x(t,r);case a.SERVICE:return new F(t,r);case a.MAP:return new q(t,r);case a.GALLERY:return new Q(t,r);case a.DATASET:return new L(t,r);default:return new C(t,r)}},e.AgolService=Z,e.TrackingEvent=ee,e.TrackingService=oe,e.TrackingCategories=X,e.TrackingTypes=$,e.TrackingEventFactory=function pe(r,e){var i=[];if(r&&e&&e.type)if(a.MAP===e.type){if(i.push(new ee(X.MAP,r,e)),$.DISPLAYED===r&&(e.layers.forEach(function(e){if(e.layer){var t=pe(r,e.layer).filter(function(e){return null!==e});t&&t.length&&(i=i.concat(t))}}),e.baseLayer)){var t=pe(r,e.baseLayer).filter(function(e){return null!==e});t&&t.length&&(i=i.concat(t))}}else if(a.LAYER===e.type)i.push(new ee(X.LAYER,r,e)),$.DISPLAYED===r&&e.services&&e.services.length&&i.push(new ee(X.SERVICE,r,e.services[0]));else{var o=function s(e){var t=X.UNKNOWN;if(e){var r=Object.keys(X).map(function(e){return X[e]});if(~r.indexOf(e))return e;if(~e.indexOf(":")){var i=e.split(":")[1];if(~r.indexOf(i))return i}}return t}(e.type);i.push(new ee(o,r,e))}return i},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=geoplatform-client.umd.min.js.map