/*
This software has been approved for release by the U.S. Department of the Interior. Although the software has been subjected to rigorous review, the DOI reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the DOI or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the DOI nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios")):"function"==typeof define&&define.amd?define("@geoplatform/client",["exports","axios"],t):t(((e=e||self).geoplatform=e.geoplatform||{},e.geoplatform.client={}),e.axios)}(this,function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(e){function t(t){var r=e.call(this,t)||this;return r.status=500,r.statusCode=500,r.error=null,r}return i(t,e),t.prototype.setError=function(e){this.error=e},t.prototype.setStatus=function(e){this.status=this.statusCode=e},t}(Error),s={DATASET:"dcat:Dataset",SERVICE:"regp:Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",ORGANIZATION:"org:Organization",CONTACT:"vcard:VCard",PERSON:"foaf:Person",CONCEPT:"skos:Concept",CONCEPT_SCHEME:"skos:ConceptScheme",STANDARD:"dct:Standard",RIGHTS_STATEMENT:"dct:RightsStatement"},n={};n[s.DATASET]="Dataset",n[s.SERVICE]="Service",n[s.LAYER]="Layer",n[s.MAP]="Map",n[s.GALLERY]="Gallery",n[s.COMMUNITY]="Community",n[s.APPLICATION]="Application",n[s.TOPIC]="Topic",n[s.WEBSITE]="WebSite",n[s.ORGANIZATION]="Organization",n[s.CONTACT]="Contact",n[s.PERSON]="Person",n[s.CONCEPT]="Concept",n[s.CONCEPT_SCHEME]="Concept Scheme",n[s.STANDARD]="Standard",n[s.RIGHTS_STATEMENT]="Rights Statement";var a="http://www.geoplatform.gov",u=["http://www.geoplatform.gov/spec/esri-feature-rest","http://www.geoplatform.gov/spec/esri-image-rest","http://www.geoplatform.gov/spec/esri-map-rest","http://www.geoplatform.gov/spec/esri-tile-rest"];function c(e){if(null===e)return"";if("string"==typeof e)return e.toLowerCase().replace(/\s/g,"");if("object"==typeof e){var t="";for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];null!=i&&(t+=(i+"").toLowerCase().replace(/\s/g,""))}return t}return""}function p(e){!function(e){if(!e)return;var t=e.serviceType||e.conformsTo;if(!t)return;if(u.indexOf(t.uri)>=0){var r=e.href||e.accessURL,i=r.match(/(Map|Feature|Image)(Server\/\d+)/i);i&&i.length>2&&(r=r.replace(i[2],"Server/"),e.href&&(e.href=r),e.accessURL&&(e.accessURL=r))}}(e);var t=e.accessURL||e.href;if(!t||!t.length)return null;var r=(t=(t=(t=(t+"").trim().toLowerCase()).replace(/http(s)?:\/\//,"")).replace(/&?request=[A-Za-z]+/i,"").replace(/&?service=(WMS|WFS|WCS|CSW)/i,"").replace(/&?version=[0-9\.]*/i,"").replace(/&?layers=[A-Za-z0-9\-\:_,]*/i,"").replace(/&?srs=[A-Za-z0-9\:]*/i,"").replace(/&?crs=[A-Za-z0-9\:]*/i,"").replace(/&?format=[A-Za-z\/]*/i,"").replace(/&?bbox=[0-9,\.]*/i,""))[t.length-1];return"/"!==r&&"?"!==r||(t=t.substring(0,t.length-1)),t}var h={factories:{},register:function(e,t){this.factories[e]=t},create:function(e,t){if(!e||!e.type)return null;if("function"!=typeof t)throw new Error("Must specify a MD5 function when using URIFactory");var r=this.factories[e.type];return r?r(e,t):null}};h.register(s.DATASET,function(e,t){var r=(e.publisher||e.publishers||[]).map(function(e){return e.label||""}).join(""),i=c({title:e.title,pub:r});return a+"/id/dataset/"+t(i)}),h.register(s.SERVICE,function(e,t){var r=c(p(e));return a+"/id/service/"+t(r)}),h.register(s.LAYER,function(e,t){var r="",i=e.servicedBy||e.services;i&&i.length&&(r=i[0].accessURL||i[0].href||"");var o=e.accessURL||e.href||"",s=r+(e.layerName||"")+o;if(!s.length)return null;var n=c(s);return a+"/id/layer/"+t(n)}),h.register(s.MAP,function(e,t){var r=e.createdBy||e._createdBy||"",i=(e.identifiers||e.identifier||[]).join(""),o=c({title:e.title,author:r,identifiers:i});return a+"/id/map/"+t(o)}),h.register(s.GALLERY,function(e,t){var r=e.createdBy||e._createdBy||"",i=c({title:e.title,author:r});return a+"/id/gallery/"+t(i)}),h.register(s.COMMUNITY,function(e,t){var r=c({title:e.title});return a+"/id/community/"+t(r)}),h.register(s.ORGANIZATION,function(e,t){var r=c(e.label||e.name);return a+"/id/organization/"+t(r)}),h.register(s.PERSON,function(e,t){var r=c(e.name);return a+"/id/person/"+t(r)}),h.register(s.CONTACT,function(e,t){var r={};return(e.email||e.hasEmail)&&(r.email=e.email||e.hasEmail),e.tel&&(r.tel=e.tel),(e.orgName||e["organization-name"])&&(r.orgName=e.orgName||e["organization-name"]),e.positionTitle&&(r.positionTitle=e.positionTitle),r=c(r),a+"/id/contact/"+t(r)}),h.register(s.CONCEPT,function(e,t){var r=e.inScheme||e.scheme,i=c(r?r.label||r.prefLabel:""),o=c(e.label||e.prefLabel);return a+"/id/metadata-codelists/"+t(i)+"/"+t(o)}),h.register(s.CONCEPT_SCHEME,function(e,t){var r=c(e.label||e.prefLabel);return a+"/id/metadata-codelists/"+t(r)}),h.register(s.APPLICATION,function(e,t){if(!e||!e.title)return null;var r=e.createdBy||e._createdBy||"",i=c({title:e.title,author:r});return a+"/id/application/"+t(i)}),h.register(s.TOPIC,function(e,t){if(!e||!e.title)return null;var r=e.createdBy||e._createdBy||"",i=c({title:e.title,author:r});return a+"/id/topic/"+t(i)}),h.register(s.WEBSITE,function(e,t){if(!e||!e.landingPage)return null;var r=c(e.landingPage);return a+"/id/website/"+t(r)});var l={ALTERNATE_TITLE:"alternateTitles",BEGINS:"startDate.min",CLASSIFIERS:"classifiers",CREATED:"created",CREATED_BEFORE:"created.max",CREATED_AFTER:"created.min",CREATED_BY:"createdBy",CREATOR:"creator.id",CONTRIBUTED_BY:"contributedBy",ENDS:"endDate.max",EXTENT:"extent",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LAST_MODIFIED_BY:"lastModifiedBy",MODIFIED:"modified",MODIFIED_BEFORE:"modified.max",MODIFIED_AFTER:"modified.min",PUBLISHERS_ID:"publisher.id",PUBLISHERS_LABEL:"publisher.label",PUBLISHERS_URI:"publisher.uri",CONTACTS_ID:"contacts.id",CONTACTS_LABEL:"contacts.label",CONTACTS_URI:"contacts.uri",QUERY:"q",SCHEMES_ID:"scheme.id",SCHEMES_LABEL:"scheme.label",SCHEMES_URI:"scheme.uri",SIMILAR_TO:"similarTo",STATUS:"status",SERVICE_TYPES:"serviceType.id",THEMES_ID:"theme.id",THEMES_LABEL:"theme.label",THEMES_URI:"theme.uri",TOPICS_ID:"topic.id",TOPICS_LABEL:"topic.label",TOPICS_URI:"topic.uri",TYPES:"type",URI:"uri",USED_BY_ID:"usedBy.id",USED_BY_LABEL:"usedBy.label",USED_BY_URI:"usedBy.uri",VISIBILITY:"visibility",RESOURCE_TYPE:"resourceType",DATASET:"dataset",LANDING_PAGE:"landingPage",PURPOSE:"purpose",RELIABILITY:"reliability",RELIABILITY_MIN:"reliability.min",RELIABILITY_MAX:"reliability.max",ONLINE:"online",COMPLIANT:"compliant",SPEED:"speed",SPEED_MIN:"speed.min",SPEED_MAX:"speed.max",LIKES:"likes",LIKES_MIN:"likes.min",LIKES_MAX:"likes.max",VIEWS:"views",VIEWS_MIN:"views.min",VIEWS_MAX:"views.max",HREF:"href",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",PARENT_LAYER:"parentLayer",SUB_LAYER:"subLayer",SERVICE:"service",MAP_LAYER:"mapLayer",GALLERY_ITEM:"galleryItem",FACETS:"includeFacets",FIELDS:"fields",SORT:"sort",PAGE:"page",PAGE_SIZE:"size",FOR_TYPES:"for"},f=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],E=function(){function e(e){this.defaultQuery={page:0,size:10,sort:"modified,desc"},this.query={page:0,size:10,sort:"modified,desc"},e&&this.applyParameters(e)}return e.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&void 0!==r.push&&(r=r.join(",")),e[t]=r}return e},e.prototype.parameter=function(e,t){return this.setParameter(e,t),this},e.prototype.setParameter=function(e,t){null==t?delete this.query[e]:this.query[e]=t},e.prototype.getParameter=function(e){return this.query[e]},e.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},e.prototype.q=function(e){return this.setQ(e),this},e.prototype.setQ=function(e){this.setParameter(l.QUERY,e)},e.prototype.getQ=function(){return this.getParameter(l.QUERY)},e.prototype.classifiers=function(e){return this.setClassifiers(e),this},e.prototype.setClassifiers=function(e){e&&("string"==typeof e&&(e=e=[e]),this.setParameter(l.TYPES,e))},e.prototype.getClassifiers=function(){return this.getParameter(l.TYPES)},e.prototype.types=function(e){return this.setTypes(e),this},e.prototype.setTypes=function(e){e&&("string"==typeof e&&(e=[e]),this.setParameter(l.FOR_TYPES,e))},e.prototype.getTypes=function(){return this.getParameter(l.FOR_TYPES)},e.prototype.page=function(e){return this.setPage(e),this},e.prototype.setPage=function(e){isNaN(e)||1*e<0||(this.query.page=1*e)},e.prototype.getPage=function(){return this.query.page},e.prototype.nextPage=function(){this.setPage(this.query.page+1)},e.prototype.previousPage=function(){this.setPage(this.query.page-1)},e.prototype.pageSize=function(e){return this.setPageSize(e),this},e.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this.query.size=1*e)},e.prototype.getPageSize=function(){return this.query.size},e.prototype.sort=function(e,t){return this.setSort(e,t),this},e.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.query.sort=e},e.prototype.getSort=function(){return this.query.sort},e.prototype.getSortField=function(){return this.query.sort.split(",")[0]},e.prototype.getSortOrder=function(){return"asc"===this.query.sort.split(",")[1]},e.prototype.getSortOptions=function(){return f.slice(0)},e.prototype.clear=function(){this.query=this.defaultQuery},e}(),g={PURPOSE:"purpose",FUNCTION:"function",TOPIC_PRIMARY:"primaryTopic",TOPIC_SECONDARY:"secondaryTopic",SUBJECT_PRIMARY:"primarySubject",SUBJECT_SECONDARY:"secondarySubject",COMMUNITY:"community",AUDIENCE:"audience",PLACE:"place",CATEGORY:"category"},y={ACCESS_RIGHTS:"rights",ALTERNATE_TITLES:"alternateTitles",ANNOTATIONS:"annotations",CLASSIFIERS:"classifiers",CONCEPT_SCHEME:"scheme",CONTACTS:"contacts",CREATED:"created",CREATED_BY:"createdBy",DATASETS:"datasets",DESCRIPTION:"description",DISTRIBUTIONS:"distributions",EXTENT:"extent",GALLERY_ITEMS:"items",HREF:"href",IDENTIFIERS:"identifiers",KEYWORDS:"keywords",LABEL:"label",LAST_MODIFIED_BY:"lastModifiedBy",LAYERS:"layers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LEGEND:"legend",MODIFIED:"modified",PARENT_LAYER:"parentLayer",PUBLISHERS:"publishers",RESOURCE_TYPES:"resourceTypes",SERVICE_TYPE:"serviceType",SERVICES:"services",SPATIAL:"spatial",STATISTICS:"statistics",STATUS:"status",SUB_LAYERS:"subLayers",TEMPORAL:"temporal",THEMES:"themes",THUMBNAIL:"thumbnail",TOPICS:"topics",USED_BY:"usedBy",VISIBILITY:"visibility",LANDING_PAGE:"landingPage"},m=[y.CREATED,y.MODIFIED,y.CREATED_BY,y.PUBLISHERS,y.THEMES,y.DESCRIPTION],d={ALTERNATE_TITLES:"alternateTitles",CONCEPT_SCHEMES:"schemes",CREATED_BY:"createdBy",HREF:"href",IDENTIFIERS:"identifiers",LAYER_TYPE:"layerType",LAYER_NAME:"layerName",LIKES:"likes",ONLINE:"online",PUBLISHERS:"publishers",CONTACTS:"contacts",RELIABILITY:"reliability",SERVICE_TYPES:"serviceTypes",SPEED:"speed",STATUS:"status",THEMES:"themes",TOPICS:"topics",TYPES:"type",USED_BY:"usedBy",VIEWS:"views",VISIBILITY:"visibility"},v=[d.TYPES,d.PUBLISHERS,d.SERVICE_TYPES,d.CONCEPT_SCHEMES,d.VISIBILITY,d.CREATED_BY],S={};S[d.TYPES]=l.TYPES,S[d.THEMES]=l.THEMES_ID,S[d.TOPICS]=l.TOPICS_ID,S[d.PUBLISHERS]=l.PUBLISHERS_ID,S[d.CONTACTS]=l.CONTACTS_ID,S[d.CONCEPT_SCHEMES]=l.SCHEMES_ID,S[d.USED_BY]=l.USED_BY_ID;var T=[{value:"label,asc",label:"Name (A-Z)"},{value:"label,desc",label:"Name (Z-A)"},{value:"type,asc",label:"Type (A-Z)"},{value:"type,desc",label:"Type (Z-A)"},{value:"modified,desc",label:"Most recently modified"},{value:"modified,asc",label:"Least recently modified"},{value:"_score,desc",label:"Relevance"}],P=/^\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?,\-?\d+(\.\d*)?$/;function I(e){var t=e;return null!==t&&void 0===t.push&&(t=[t]),null===t||t.length||(t=null),t}var R=function(){function e(e){this.defaultQuery={},this.defaultQuery[l.PAGE.toString()]=0,this.defaultQuery[l.PAGE_SIZE.toString()]=10,this.defaultQuery[l.SORT.toString()]="modified,desc",this.defaultQuery[l.FIELDS.toString()]=m.slice(0),this.defaultQuery[l.FACETS.toString()]=v.slice(0),e&&e.defaults&&(Object.assign(this.defaultQuery,e.defaults),delete e.defaults),this.query=JSON.parse(JSON.stringify(this.defaultQuery)),e&&this.applyParameters(e)}return e.prototype.getQuery=function(){var e={};for(var t in this.query){var r=this.query[t];null!==r&&void 0!==r.push&&(r=r.join(",")),e[t]=r}return e},e.prototype.clone=function(){var t=new e,r=JSON.parse(JSON.stringify(this.query));return t.applyParameters(r),t},e.prototype.parameter=function(e,t){return this.setParameter(e,t),this},e.prototype.setParameter=function(e,t){null==t||void 0!==t.push&&!t.length?delete this.query[e]:this.query[e]=t},e.prototype.getParameter=function(e){return this.query[e]},e.prototype.clearParameter=function(e){delete this.query[e]},e.prototype.applyParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])},e.prototype.setFacetParameter=function(e,t){var r=S[e];r||console.log("WARN : Query.applyFacetParameter() - unable to map facet to known parameter '"+e+"', using as direct parameter which may not operate as intended"),this.setParameter(r||e,t)},e.prototype.q=function(e){return this.setQ(e),this},e.prototype.setQ=function(e){this.setParameter(l.QUERY,e)},e.prototype.getQ=function(){return this.getParameter(l.QUERY)},e.prototype.keywords=function(e){return this.setKeywords(e),this},e.prototype.setKeywords=function(e){this.setParameter(l.KEYWORDS,I(e))},e.prototype.getKeywords=function(){return this.getParameter(l.KEYWORDS)},e.prototype.uri=function(e){return this.setUri(e),this},e.prototype.setUri=function(e){this.setParameter(l.URI,e)},e.prototype.getUri=function(){return this.getParameter(l.URI)},e.prototype.types=function(e){return this.setTypes(e),this},e.prototype.setTypes=function(e){this.setParameter(l.TYPES,I(e))},e.prototype.getTypes=function(){return this.getParameter(l.TYPES)},e.prototype.createdBy=function(e){return this.setCreatedBy(e),this},e.prototype.setCreatedBy=function(e){this.setParameter(l.CREATED_BY,e)},e.prototype.getCreatedBy=function(){return this.getParameter(l.CREATED_BY)},e.prototype.lastModifiedBy=function(e){return this.setLastModifiedBy(e),this},e.prototype.setLastModifiedBy=function(e){this.setParameter(l.LAST_MODIFIED_BY,e)},e.prototype.getLastModifiedBy=function(){return this.getParameter(l.LAST_MODIFIED_BY)},e.prototype.themes=function(e,t){return this.setThemes(e,t),this},e.prototype.setThemes=function(e,t){this.setParameter(l.THEMES_ID,null),this.setParameter(l.THEMES_LABEL,null),this.setParameter(l.THEMES_URI,null);var r=t||l.THEMES_ID;this.setParameter(r,I(e))},e.prototype.getThemes=function(){return this.getParameter(l.THEMES_ID)||this.getParameter(l.THEMES_LABEL)||this.getParameter(l.THEMES_URI)},e.prototype.topics=function(e,t){return this.setTopics(e,t),this},e.prototype.setTopics=function(e,t){this.setParameter(l.TOPICS_ID,null),this.setParameter(l.TOPICS_LABEL,null),this.setParameter(l.TOPICS_URI,null);var r=t||l.TOPICS_ID;this.setParameter(r,I(e))},e.prototype.getTopics=function(){return this.getParameter(l.TOPICS_ID)||this.getParameter(l.TOPICS_LABEL)||this.getParameter(l.TOPICS_URI)},e.prototype.publishers=function(e,t){return this.setPublishers(e,t),this},e.prototype.setPublishers=function(e,t){this.setParameter(l.PUBLISHERS_ID,null),this.setParameter(l.PUBLISHERS_LABEL,null),this.setParameter(l.PUBLISHERS_URI,null);var r=t||l.PUBLISHERS_ID;this.setParameter(r,I(e))},e.prototype.getPublishers=function(){return this.getParameter(l.PUBLISHERS_ID)||this.getParameter(l.PUBLISHERS_LABEL)||this.getParameter(l.PUBLISHERS_URI)},e.prototype.contacts=function(e,t){return this.setContacts(e,t),this},e.prototype.setContacts=function(e,t){this.setParameter(l.CONTACTS_ID,null),this.setParameter(l.CONTACTS_LABEL,null),this.setParameter(l.CONTACTS_URI,null);var r=t||l.CONTACTS_ID;this.setParameter(r,I(e))},e.prototype.getContacts=function(){return this.getParameter(l.CONTACTS_ID)||this.getParameter(l.CONTACTS_LABEL)||this.getParameter(l.CONTACTS_URI)},e.prototype.usedBy=function(e,t){return this.setUsedBy(e,t),this},e.prototype.setUsedBy=function(e,t){this.setParameter(l.USED_BY_ID,null),this.setParameter(l.USED_BY_LABEL,null),this.setParameter(l.USED_BY_URI,null);var r=t||l.USED_BY_ID;this.setParameter(r,I(e))},e.prototype.getUsedBy=function(){return this.getParameter(l.USED_BY_ID)||this.getParameter(l.USED_BY_LABEL)||this.getParameter(l.USED_BY_URI)},e.prototype.schemes=function(e,t){return this.setSchemes(e,t),this},e.prototype.setSchemes=function(e,t){this.setParameter(l.SCHEMES_ID,null),this.setParameter(l.SCHEMES_LABEL,null),this.setParameter(l.SCHEMES_URI,null);var r=t||l.SCHEMES_ID;this.setParameter(r,I(e))},e.prototype.getSchemes=function(){return this.getParameter(l.SCHEMES_ID)||this.getParameter(l.SCHEMES_LABEL)||this.getParameter(l.SCHEMES_URI)},e.prototype.serviceTypes=function(e){return this.setServiceTypes(e),this},e.prototype.setServiceTypes=function(e){this.setParameter(l.SERVICE_TYPES,I(e))},e.prototype.getServiceTypes=function(){return this.getParameter(l.SERVICE_TYPES)},e.prototype.visibility=function(e){return this.setVisibility(e),this},e.prototype.setVisibility=function(e){this.setParameter(l.VISIBILITY,e)},e.prototype.getVisibility=function(){return this.getParameter(l.VISIBILITY)},e.prototype.status=function(e){return this.setStatus(e),this},e.prototype.setStatus=function(e){this.setParameter(l.STATUS,e)},e.prototype.getStatus=function(){return this.getParameter(l.STATUS)},e.prototype.extent=function(e){return this.setExtent(e),this},e.prototype.setExtent=function(e){if(e)if(void 0!==e.toBboxString)e=e.toBboxString();else if(void 0!==e.push&&e.length&&void 0!==e[0].push)e=e[0][1]+","+e[0][0]+","+e[1][1]+","+e[1][0];else{if("string"!=typeof e)throw new Error("Invalid argument: bbox must be one of Leaflet.Bounds, nested array, or bbox string");if(!P.test(e))throw new Error("Invalid argument: bbox string must be in form of 'minx,miny,maxx,maxy'")}this.setParameter(l.EXTENT,e)},e.prototype.getExtent=function(){return this.getParameter(l.EXTENT)},e.prototype.classifier=function(e,t){return this.setClassifier(e,t),this},e.prototype.setClassifier=function(e,t){var r=I(t);this.setParameter(l.CLASSIFIERS+"."+e,r)},e.prototype.getClassifier=function(e){return this.getParameter(l.CLASSIFIERS+"."+e)||[]},e.prototype.classifiers=function(e){return this.setClassifiers(e),this},e.prototype.setClassifiers=function(e){var t=this,r=Object.keys(g).map(function(e){return g[e]});e&&"object"==typeof e&&!Array.isArray(e)?Object.keys(e).forEach(function(i){~r.indexOf(i)&&t.setClassifier(i,e[i])}):r.forEach(function(e){t.clearParameter(l.CLASSIFIERS+"."+e)})},e.prototype.getClassifiers=function(){var e=this,t={};return Object.keys(g).map(function(e){return g[e]}).forEach(function(r){t[r]=e.getClassifier(r)}),t},e.prototype.modified=function(e,t){return this.setModified(e,t),this},e.prototype.setModified=function(e,t){if(!e)return this.setParameter(l.MODIFIED_BEFORE,null),void this.setParameter(l.MODIFIED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?l.MODIFIED_BEFORE:l.MODIFIED_AFTER,o=r?l.MODIFIED_AFTER:l.MODIFIED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},e.prototype.getModified=function(){var e=this.getParameter(l.MODIFIED_BEFORE)||this.getParameter(l.MODIFIED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},e.prototype.created=function(e,t){return this.setCreated(e,t),this},e.prototype.setCreated=function(e,t){if(!e)return this.setParameter(l.CREATED_BEFORE,null),void this.setParameter(l.CREATED_AFTER,null);e instanceof Date||(e=new Date(e));var r=t&&(!0===t||"true"===t),i=r?l.CREATED_BEFORE:l.CREATED_AFTER,o=r?l.CREATED_AFTER:l.CREATED_BEFORE,s=e&&e.getTime?e.getTime():e;this.setParameter(o,null),this.setParameter(i,s)},e.prototype.getCreated=function(){var e=this.getParameter(l.CREATED_BEFORE)||this.getParameter(l.CREATED_AFTER);return e&&"number"==typeof e&&(e=new Date(e)),e},e.prototype.begins=function(e){return this.setBeginDate(e),this},e.prototype.setBeginDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(l.BEGINS,e)},e.prototype.getBeginDate=function(){var e=this.getParameter(l.BEGINS);return e&&(e=new Date(e)),e},e.prototype.ends=function(e){return this.setEndDate(e),this},e.prototype.setEndDate=function(e){e&&e instanceof Date&&(e=e.getTime()),this.setParameter(l.ENDS,e)},e.prototype.getEndDate=function(){var e=this.getParameter(l.ENDS);return e&&(e=new Date(e)),e},e.prototype.between=function(e,t){return this.setBetween(e,t),this},e.prototype.setBetween=function(e,t){this.begins(e),this.ends(t)},e.prototype.resourceTypes=function(e){return this.setResourceTypes(e),this},e.prototype.setResourceTypes=function(e){this.setParameter(l.RESOURCE_TYPE,I(e))},e.prototype.getResourceTypes=function(){return this.getParameter(l.RESOURCE_TYPE)},e.prototype.facets=function(e){return this.setFacets(e),this},e.prototype.setFacets=function(e){this.setParameter(l.FACETS,I(e))},e.prototype.getFacets=function(){return this.getParameter(l.FACETS)},e.prototype.addFacet=function(e){var t=this.getFacets()||[];t.push(e),this.setFacets(t)},e.prototype.removeFacet=function(e){var t=this.getFacets()||[],r=t.indexOf(e);r>=0&&(t.splice(r,1),this.setFacets(t))},e.prototype.fields=function(e){return this.setFields(e),this},e.prototype.setFields=function(e){this.setParameter(l.FIELDS,I(e))},e.prototype.getFields=function(){return this.getParameter(l.FIELDS)},e.prototype.addField=function(e){var t=this.getFields()||[];t.push(e),this.setFields(t)},e.prototype.removeField=function(e){var t=this.getFields()||[],r=t.indexOf(e);r>=0&&(t.splice(r,1),this.setFields(t))},e.prototype.page=function(e){return this.setPage(e),this},e.prototype.setPage=function(e){isNaN(e)||1*e<0||this.setParameter(l.PAGE,1*e)},e.prototype.getPage=function(){return this.getParameter(l.PAGE)},e.prototype.nextPage=function(){this.setPage(this.getPage()+1)},e.prototype.previousPage=function(){this.setPage(this.getPage()-1)},e.prototype.pageSize=function(e){return this.setPageSize(e),this},e.prototype.setPageSize=function(e){isNaN(e)||1*e<0||this.setParameter(l.PAGE_SIZE,1*e)},e.prototype.getPageSize=function(){return this.getParameter(l.PAGE_SIZE)},e.prototype.sort=function(e,t){return this.setSort(e,t),this},e.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this.setParameter(l.SORT,e)},e.prototype.getSort=function(){return this.getParameter(l.SORT)},e.prototype.getSortField=function(){var e=this.getSort();return e&&e.length?e.split(",")[0]:null},e.prototype.getSortOrder=function(){var e=this.getSort();return e&&e.length?e.split(",")[1]:null},e.prototype.getSortOptions=function(){return T.slice(0)},e.prototype.clear=function(){this.query=JSON.parse(JSON.stringify(this.defaultQuery))},e}();var A={ualUrl:"https://ual.geoplatform.gov",configure:function(e){Object.assign(this,e)}},b=function(){function e(e){this.timeout=5e3,this.authCookieName="gpoauth-a",e=e||{},this.setTimeout(e.timeout||3e4),this.setAuthToken(e.token),this.setCookie(e.cookie)}return e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.setAuthToken=function(e){e&&"string"==typeof e?this.token=function(){return e}:e&&"function"==typeof e&&(this.token=e)},e.prototype.getToken=function(){return this.token&&"function"==typeof this.token?this.token():this.token||null},e.prototype.setCookie=function(e){this.cookie=e},e.prototype.getCookie=function(){return this.cookie},e.prototype.createRequestOpts=function(e){throw new Error("Must implement 'createRequestOpts' in a sub-class")},e.prototype.execute=function(e){return Promise.reject(new Error("Must overrdie 'execute' in a sub-class"))},e}(),O=function(e){function r(t){return e.call(this,t)||this}return i(r,e),r.prototype.createRequestOpts=function(e){var t={method:e.method,url:e.url,timeout:e.timeout||this.timeout};if(!0===e.json&&(t.responseType="json"),e.params&&(t.params=e.params),e.data&&(t.data=e.data,t.contentType="application/json"),t.headers={},e.headers&&Object.assign(t.headers,e.headers),this.token){var r=this.token();r&&(t.headers.Authorization="Bearer "+r,t.withCredentials=!0)}var i=this.getCookie();if(i&&(t.headers.Cookie=this.authCookieName+"="+i),e.options)for(var o in e.options)e.options.hasOwnProperty(o)&&(t[o]=e.options[o]);return t},r.prototype.execute=function(e){if(void 0===t)throw new Error("Axios not found, check that you have included it as a dependency of the application or use a different HttpClient implementation");return t(e).then(function(e){return e.data}).catch(function(e){var t=new o(e.message);throw e.response&&(t=new o(e.response.data)),t})},r}(b),C=function(){function e(e,t){this._timeout=3e4,this.httpMethods=["GET","POST","PUT","DELETE","PATCH"],this.setUrl(e),this.client=t}return e.prototype.setUrl=function(e){this.apiBase=e,this.baseUrl=e+"/api/items"},e.prototype.setTimeout=function(e){this._timeout=e},e.prototype.timeout=function(e){return this.setTimeout(e),this},e.prototype.getClient=function(){return this.client},e.prototype.createPromise=function(e){return new Promise(e)},e.prototype.createAndResolvePromise=function(e){return Promise.resolve(e)},e.prototype.createAndRejectPromise=function(e){return Promise.reject(e)},e.prototype.setLogger=function(e){this.logger=e},e.prototype.logError=function(e){this.logger&&this.logger.error&&this.logger.error(e)},e.prototype.logDebug=function(e){this.logger&&this.logger.debug&&this.logger.debug(e)},e.prototype.buildRequest=function(e){if(this.httpMethods.indexOf(e.method)<0)throw new Error("Unsupported HTTP method "+e.method);if(!e.url)throw new Error("Must specify a URL for HTTP requests");return e.timeout=this._timeout||3e4,this.createRequestOpts(e)},e.prototype.createRequestOpts=function(e){if("object"==typeof e.options){var t=e.options;delete e.options,t.params&&e.params&&(Object.keys(e.params).forEach(function(r){t.params[r]=e.params[r]}),delete e.params),Object.assign(t,e),e=t}var r=this.client.createRequestOpts(e);return this.logDebug("BaseService.createRequestOpts() - "+JSON.stringify(r)),r},e.prototype.execute=function(e){var t=this;return this.client.execute(e).catch(function(e){return null==e&&(e=new Error("Request failed but didn't return an error. This is most likely because the request timed out")),t.createAndRejectPromise(e)})},e}(),w=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.get=function(e,t){var r=this,i=this.baseUrl+"/"+e;return t&&t.version&&(i+="/versions/"+t.version),this.createAndResolvePromise(i).then(function(e){var i=r.buildRequest({method:"GET",url:e,options:t});return r.execute(i)}).catch(function(t){var i=new Error("Error fetching item "+e+": "+t.message);throw Object.assign(i,t),r.logError("ItemService.get() - "+i.message),i})},t.prototype.save=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i="POST",o=r.baseUrl;if(e.id)i="PUT",o+="/"+e.id;else if(!e.uri)return r.getUri(e,t).then(function(s){e.uri=s;var n=r.buildRequest({method:i,url:o,data:e,options:t});return r.execute(n)});var s=r.buildRequest({method:i,url:o,data:e,options:t});return r.execute(s)}).catch(function(e){var t=new Error("Error saving item: "+e.message);throw Object.assign(t,e),r.logError("ItemService.save() - "+t.message),t})},t.prototype.remove=function(e,t){var r=this;return this.createAndResolvePromise(this.baseUrl+"/"+e).then(function(e){var i=r.buildRequest({method:"DELETE",url:e,options:t});return r.execute(i)}).then(function(){return!0}).catch(function(t){var i=new Error("Error deleting item "+e+": "+t.message);throw Object.assign(i,t),r.logError("ItemService.remove() - "+i.message),i})},t.prototype.patch=function(e,t,r){var i=this;return this.createAndResolvePromise(this.baseUrl+"/"+e).then(function(e){var o=i.buildRequest({method:"PATCH",url:e,data:t,options:r});return i.execute(o)}).catch(function(t){var r=new Error("Error patching item "+e+": "+t.message);throw Object.assign(r,t),i.logError("ItemService.patch() - "+r.message),r})},t.prototype.clone=function(e,t,r){var i=this;return this.createAndResolvePromise(this.baseUrl+"/"+e+"/clone").then(function(e){var o=i.buildRequest({method:"POST",url:e,data:t,options:r});return i.execute(o)}).catch(function(t){var r=new Error("Error cloning item "+e+": "+t.message);throw Object.assign(r,t),i.logError("ItemService.clone() - "+r.message),r})},t.prototype.search=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i={};i=e&&"function"==typeof e.getQuery?e.getQuery():"object"==typeof e?e:{};var o=r.buildRequest({method:"GET",url:r.baseUrl,params:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error searching items: "+e.message);throw Object.assign(t,e),r.logError("ItemService.search() - "+t.message),t})},t.prototype.import=function(e,t,r){var i=this;return this.createAndResolvePromise(!0).then(function(){if(null==e)throw new Error("Must provide a valid URL or File");var o="string"!=typeof e,s={method:"POST",url:i.apiBase+"/api/import",processData:!0,formData:!0,options:r};o?(s.file=e,s.data={format:t}):(s.formData=!1,s.data={url:e,format:t}),r&&r.overwrite&&(s.data.overwrite=!!r.overwrite+"",delete r.overwrite);var n=i.buildRequest(s);return i.execute(n)}).catch(function(e){var t=new Error("Error importing item: "+(e.message||e));throw Object.assign(t,e),(409===e.status||e.message&&~e.message.indexOf("Item already exists"))&&Object.assign(t,{status:409}),e.item&&Object.assign(t,{item:e.item}),i.logError("ItemService.import() - "+(t.message||e)),t})},t.prototype.export=function(e,t,r){var i=this;return this.createAndResolvePromise(!0).then(function(){var o=i.baseUrl+"/"+e+"/export",s=i.buildRequest({method:"GET",url:o,params:{format:t},json:!1,options:r});return i.execute(s)}).catch(function(e){var r=e.message;(e.statusCode&&406===e.statusCode||"406"===e.statusCode)&&(r="Unsupported export format specified '"+t+"'");var o=new Error("Error exporting item: "+r);throw Object.assign(o,e),i.logError("ItemService.export() - "+o.message),o})},t.prototype.getUri=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){if(!e||!e.type)throw new Error("Must provide an object with a type property");var i=r.apiBase+"/api/utils/uri";(t=t||{}).responseType="text";var o=r.buildRequest({method:"POST",url:i,data:e,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error getting URI for item: "+e.message);throw Object.assign(t,e),r.logError("ItemService.getUri() - "+t.message),t})},t.prototype.getMultiple=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.apiBase+"/api/fetch",o=r.buildRequest({method:"POST",url:i,data:e,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error fetching items: "+e.message);throw Object.assign(t,e),r.logError("ItemService.getMultiple() - "+t.message),t})},t.prototype.exists=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.apiBase+"/api/utils/exists",o=r.buildRequest({method:"POST",url:i,data:e,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error resolving items: "+e.message);throw Object.assign(t,e),r.logError("ItemService.exists() - "+t.message),t})},t.prototype.like=function(e,t){var r=this;return this.createAndResolvePromise(e.id).then(function(e){var i=r.apiBase+"/api/items/"+e+"/likes",o=r.buildRequest({method:"PUT",url:i,options:t});return r.execute(o)}).catch(function(t){var i=new Error("Error liking item "+e.id+": "+t.message);throw Object.assign(i,t),r.logError("ItemService.like() - "+i.message),i})},t.prototype.view=function(e,t){var r=this;return this.createAndResolvePromise(e.id).then(function(e){var i=r.apiBase+"/api/items/"+e+"/views",o=r.buildRequest({method:"PUT",url:i,options:t});return r.execute(o)}).catch(function(t){var i=new Error("Error incrementing views for item "+e.id+": "+t.message);throw Object.assign(i,t),r.logError("ItemService.like() - "+i.message),i})},t.prototype.associations=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){var o=i.baseUrl+"/"+e+"/associations",s=i.buildRequest({method:"GET",url:o,params:t||{},options:r});return i.execute(s)}).catch(function(t){var r=new Error("Error fetching associations for item "+e+": "+t.message);throw Object.assign(r,t),i.logError("ItemService.associations() - "+r.message),r})},t.prototype.versions=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){var o=i.baseUrl+"/"+e+"/versions",s=i.buildRequest({method:"GET",url:o,params:t,options:r});return i.execute(s)}).catch(function(t){var r=new Error("Error fetching versions for item "+e+": "+t.message);throw Object.assign(r,t),i.logError("ItemService.versions() - "+r.message),r})},t}(C),_=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/datasets"},t}(w),D=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/maps"},t}(w),L=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/layers"},t.prototype.style=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this.createAndResolvePromise(e).then(function(e){var i={params:null},o=t.baseUrl+"/"+e+"/style";r[0]&&"string"==typeof r[0]?(o+="s/"+r[0],r[1]&&(i.params=r[1])):r[0]&&"object"==typeof r[0]&&(i.params=r[0]);var s=t.buildRequest({method:"GET",url:o,options:i});return t.execute(s)}).catch(function(e){var r=new Error("Error fetching style: "+e.message);throw Object.assign(r,e),t.logError("LayerService.style() - "+r.message),r})},t.prototype.styles=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.baseUrl+"/"+e+"/styles",o=r.buildRequest({method:"GET",url:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error fetching style: "+e.message);throw Object.assign(t,e),r.logError("LayerService.style() - "+t.message),t})},t.prototype.describe=function(e,t,r){var i=this;return this.createAndResolvePromise(t).then(function(t){if(!t)throw new Error("Must provide describe parameters to use");var o=["bbox","height","width","x","y"].find(function(e){return!t[e]});if(o)throw new Error("Must specify "+o+" in describe req");var s={srs:"EPSG:4326",bbox:t.bbox,height:t.height,width:t.width,info_format:"text/xml",x:t.x,y:t.y,i:t.x,j:t.y},n=i.baseUrl+"/"+e+"/describe",a=i.buildRequest({method:"GET",url:n,params:s,options:r});return i.execute(a)}).catch(function(e){var t=new Error("Error describing layer feature: "+e.message);throw Object.assign(t,e),i.logError("LayerService.describe() - "+t.message),t})},t.prototype.validate=function(e,t,r){var i=this;return this.createAndResolvePromise(t).then(function(t){if(!t)throw new Error("Must provide parameters to use in layer validation");var o=i.baseUrl+"/"+e+"/validate",s=i.buildRequest({method:"GET",url:o,params:t,options:r});return i.execute(s)}).catch(function(e){var t=new Error("Error validating layer request: "+e.message);throw Object.assign(t,e),i.logError("LayerService.describe() - "+t.message),t})},t}(w),U=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/services"},t.prototype.about=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){if(!e)throw new Error("Must provide service to get metadata about");var i=r.buildRequest({method:"POST",url:r.baseUrl+"/about",data:e,options:t});return r.execute(i)}).catch(function(e){var t=new Error("Error describing service: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.about() - "+t.message),t})},t.prototype.layers=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){if(!e)throw new Error("Must provide service identifier");var i=r.buildRequest({method:"GET",url:r.baseUrl+"/"+e+"/layers",options:t});return r.execute(i)}).catch(function(e){var t=new Error("Error fetching service layers: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.layers() - "+t.message),t})},t.prototype.types=function(e){var t=this,r=(new R).types(s.STANDARD).resourceTypes("ServiceType").pageSize(50).getQuery();return this.createAndResolvePromise(r).then(function(r){var i=t.apiBase+"/api/items",o=t.buildRequest({method:"GET",url:i,params:r,options:e});return t.execute(o)}).then(function(e){return e.results}).catch(function(e){var r=new Error("Error fetching service types: "+e.message);throw Object.assign(r,e),t.logError("ServiceService.types() - "+r.message),r})},t.prototype.import=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.baseUrl+"/import",o=r.buildRequest({method:"POST",url:i,data:e,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error importing service: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.import() - "+t.message),t})},t.prototype.harvest=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.baseUrl+"/"+e+"/harvest",o=r.buildRequest({method:"GET",url:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error harvesting layers from service: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.harvest() - "+t.message),t})},t.prototype.liveTest=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.baseUrl+"/"+e+"/test",o=r.buildRequest({method:"GET",url:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error testing service: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.liveTest() - "+t.message),t})},t.prototype.statistics=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.baseUrl+"/"+e+"/statistics",o=r.buildRequest({method:"GET",url:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("Error getting service statistics: "+e.message);throw Object.assign(t,e),r.logError("ServiceService.statistics() - "+t.message),t})},t}(w),N=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/galleries"},t.prototype.addItem=function(e,t,r){var i=this;return this.createAndResolvePromise(!0).then(function(){var o=i.baseUrl+"/"+e+"/items",s=i.buildRequest({method:"POST",url:o,data:t,options:r});return i.execute(s)}).catch(function(e){var t=new Error("Error adding item: "+e.message);throw Object.assign(t,e),i.logError("GalleryService.addItem() - "+t.message),t})},t.prototype.removeItem=function(e,t,r){var i=this;return this.createAndResolvePromise(this.baseUrl+"/"+e+"/items/"+t).then(function(e){var t=i.buildRequest({method:"DELETE",url:e,options:r});return i.execute(t)}).then(function(){return!0}).catch(function(e){var t=new Error("Error adding item: "+e.message);throw Object.assign(t,e),i.logError("GalleryService.addItem() - "+t.message),t})},t}(w),B=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.setTimeout(3e4),i}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t},t.prototype.capabilities=function(e,t,r){var i=this,o=this.baseUrl+"/api/capabilities";return e&&(o+="/"+e),this.createAndResolvePromise(o).then(function(e){var o=i.buildRequest({method:"GET",url:e,params:t||{},options:r});return i.execute(o)}).catch(function(e){var t=new Error("Error getting capabilities: "+e.message);throw Object.assign(t,e),i.logError("UtilsService.capabilities() - "+t.message),t})},t.prototype.parseFile=function(e,t,r){var i=this,o=this.baseUrl+"/api/utils/parse";return this.createAndResolvePromise(o).then(function(o){var s=i.buildRequest({method:"POST",url:o,data:{format:t},file:e,formData:!0,options:r});return i.execute(s)}).then(function(e){return e}).catch(function(e){var t=new Error("Error parsing file: "+e.message);throw Object.assign(t,e),i.logError("UtilsService.parseFile() - "+t.message),t})},t.prototype.locate=function(e,t){var r=this,i=this.baseUrl+"/api/utils/gazetteer";return this.createAndResolvePromise(i).then(function(i){var o=r.buildRequest({method:"GET",url:i,params:{location:e},options:t});return r.execute(o)}).then(function(e){return e}).catch(function(e){var t=new Error("Error resolving location: "+e.message);throw Object.assign(t,e),r.logError("UtilsService.locate() - "+t.message),t})},t.prototype.store=function(e,t,r){var i=this,o=this.baseUrl+"/api/store";return this.createAndResolvePromise(o).then(function(o){var s=i.buildRequest({method:"POST",url:o,data:{format:t},file:e,formData:!0,options:r});return i.execute(s)}).then(function(e){return e}).catch(function(e){var t=new Error("Error uploading file for storage: "+e.message);throw Object.assign(t,e),i.logError("UtilsService.store() - "+t.message),t})},t}(C),M=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.search=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){if(!e)throw new Error("Must specify a GeoPlatform resource for which to search associations");var o=i.baseUrl+"/"+e+"/associations",s=i.buildRequest({method:"GET",url:o,params:t||{},options:r});return i.execute(s)}).catch(function(t){var r=new Error("Error fetching associations for item "+e+": "+t.message);throw Object.assign(r,t),i.logError("AssociationService.search("+e+") - "+r.message),r})},t.prototype.get=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){if(!e||!t)throw new Error("Must specify both the GeoPlatform resource id and its association's id");var o=i.baseUrl+"/"+e+"/associations/"+t,s=i.buildRequest({method:"GET",url:o,options:r});return i.execute(s)}).catch(function(r){var o=new Error("Error fetching association for item "+e+": "+r.message);throw Object.assign(o,r),i.logError("AssociationService.get("+e+","+t+") - "+o.message),o})},t.prototype.remove=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){if(!e||!t)throw new Error("Must specify both the GeoPlatform resource id and its association's id");var o=i.baseUrl+"/"+e+"/associations/"+t,s=i.buildRequest({method:"DELETE",url:o,options:r});return i.execute(s)}).catch(function(r){var o=new Error("Error removing association for item "+e+": "+r.message);throw Object.assign(o,r),i.logError("AssociationService.remove("+e+","+t+") - "+o.message),o})},t}(C),x=function(){function e(e){if(this._query={page:0,size:10},e)for(var t in e)e.hasOwnProperty(t)&&(this._query[t]=e[t])}return e.prototype.getQuery=function(){var e={};for(var t in this._query){var r=this._query[t];null!==r&&void 0!==r.push&&(r=r.join(",")),e[t]=r}return e},e.prototype.q=function(e){return this.setQ(e),this},e.prototype.setQ=function(e){this._query.q=e},e.prototype.getQ=function(){return this._query.q},e.prototype.types=function(e){return this.setTypes(e),this},e.prototype.setTypes=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.types=t},e.prototype.getTypes=function(){return this._query.types},e.prototype.groups=function(e){return this.setGroups(e),this},e.prototype.setGroups=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.groups=t},e.prototype.getGroups=function(){return this._query.groups},e.prototype.orgs=function(e){return this.setOrgs(e),this},e.prototype.setOrgs=function(e){var t;t=e&&Array.isArray(e)?e.join(","):e,this._query.orgs=t},e.prototype.getOrgs=function(){return this._query.orgs},e.prototype.extent=function(e){return this.setExtent(e),this},e.prototype.setExtent=function(e){this._query.bbox=e},e.prototype.getExtent=function(){return this._query.bbox},e.prototype.sort=function(e,t){return this.setSort(e,t),this},e.prototype.setSort=function(e,t){t=t||"desc",e&&e.indexOf(",")<0&&(e=e+","+t),this._query.sort=e},e.prototype.getSort=function(){return this._query.sort},e.prototype.getSortField=function(){return this._query.sort.split(",")[0]},e.prototype.getSortOrder=function(){return"asc"===this._query.sort.split(",")[1]},e.prototype.page=function(e){return this.setPage(e),this},e.prototype.setPage=function(e){isNaN(e)||1*e<0||(this._query.page=1*e)},e.prototype.getPage=function(){return this._query.page},e.prototype.nextPage=function(){this.setPage(this._query.page+1)},e.prototype.previousPage=function(){this.setPage(this._query.page-1)},e.prototype.pageSize=function(e){return this.setPageSize(e),this},e.prototype.setPageSize=function(e){isNaN(e)||1*e<0||(this._query.size=1*e)},e.prototype.getPageSize=function(){return this._query.size},e}(),q=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.setTimeout(3e4),i}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/agol"},t.prototype.getOrg=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.buildRequest({method:"GET",url:r.baseUrl+"/orgs/"+e,options:t});return r.execute(i)}).catch(function(t){var r=new Error("AgolService.getOrg() - Error fetching org "+e+": "+t.message);throw Object.assign(r,t),r})},t.prototype.searchOrgs=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=e.getQuery(),o=r.buildRequest({method:"GET",url:r.baseUrl+"/orgs",params:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("AgolService.searchOrgs() - Error searching orgs: "+e.message);throw Object.assign(t,e),t})},t.prototype.getGroup=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.buildRequest({method:"GET",url:r.baseUrl+"/groups/"+e,options:t});return r.execute(i)}).catch(function(t){var r=new Error("AgolService.getGroup() - Error fetching group "+e+": "+t.message);throw Object.assign(r,t),r})},t.prototype.searchGroups=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=e.getQuery(),o=r.buildRequest({method:"GET",url:r.baseUrl+"/groups",params:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("AgolService.searchGroups() - Error searching groups: "+e.message);throw Object.assign(t,e),t})},t.prototype.getItem=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=r.buildRequest({method:"GET",url:r.baseUrl+"/items/"+e,options:t});return r.execute(i)}).catch(function(t){var r=new Error("AgolService.getItem() - Error fetching item "+e+": "+t.message);throw Object.assign(r,t),r})},t.prototype.searchItems=function(e,t){var r=this;return this.createAndResolvePromise(e).then(function(e){var i=e.getQuery(),o=r.buildRequest({method:"GET",url:r.baseUrl+"/items",params:i,options:t});return r.execute(o)}).catch(function(e){var t=new Error("AgolService.searchItems() - Error searching items: "+e.message);throw Object.assign(t,e),t})},t.prototype.getAgolId=function(e){if(!e)return null;if(!e.type)return null;if(s.ORGANIZATION===e.type||"Group"===e.type)return e.id;if(!e.identifiers||!e.identifiers.length)return null;var t=e.identifiers.filter(function(e){return~e.indexOf("agol:")});return t.length?t[0].replace("agol:",""):null},t}(C),Y={UNKNOWN:"Unknown Category",DATASET:"Dataset",SERVICE:"Service",LAYER:"Layer",MAP:"Map",GALLERY:"Gallery",COMMUNITY:"Community",CONTACT:"Contact",ORGANIZATION:"Organization",CONCEPT:"Concept",CONCEPT_SCHEME:"Concept Scheme",APPLICATION:"Application",TOPIC:"Topic",WEBSITE:"WebSite",IMAGE_PRODUCT:"Image Product",RIGHTS_STATEMENT:"RightsStatement",KNOWLEDGE_GRAPH:"Knowledge Graph",USER:"User",COMMUNITY_POST:"Community Post",COMMUNITY_PAGE:"Community Page",APP_PAGE:"Application Page"},F={ACCESSED:"Accessed",DISPLAYED:"Displayed",VIEWED:"Viewed",CREATED:"Created",EDITED:"Edited",DELETED:"Deleted",CLONED:"Cloned",ADDED:"Added",REMOVED:"Removed",EXPORTED:"Exported",IMPORTED:"Imported"};var j=function(){function e(e,t,r,i){if(this.item=null,this.related=null,!e||!t)throw new Error("TrackingService Event - Must specific an event category and event type when constructing events");this.category=e,this.type=t,this.setItem(r),this.setRelated(i)}return e.prototype.getCategory=function(){return this.category},e.prototype.getType=function(){return this.type},e.prototype.getItem=function(){return this.item},e.prototype.setItem=function(e){this.item=e?e.id||e:null},e.prototype.getRelated=function(){return this.related},e.prototype.setRelated=function(e){this.related=e?e.id||e:null},e}();var G=function(){function e(){}return e.prototype.logEvent=function(e,t,r,i){console.log("Event ("+e+") - "+t+" : "+r)},e.prototype.logPageView=function(e,t){console.log("Page View "+e+(t?" : "+JSON.stringify(t):""))},e.prototype.logSearch=function(e,t){console.log("Query : "+JSON.stringify(e)+" found "+t+" matches")},e}(),H=function(){function e(e){this.provider=null,e&&"object"==typeof e&&Object.assign(this,e),this.provider||this.setProvider(new G)}return e.prototype.setProvider=function(e){e&&(this.provider=e)},e.prototype.event=function(e){return this.logEvent(e),this},e.prototype.logEvent=function(e){var t=this;if(this.provider&&this.provider.logEvent&&e)if(Array.isArray(e)){e.forEach(function(e){return t.logEvent(e)})}else{var r=e;try{this.provider.logEvent(r.getCategory(),r.getType(),r.getItem(),r.getRelated())}catch(e){console.log("TrackingService.logEvent() - Error logging event ("+r.getCategory()+", "+r.getType()+", "+r.getItem()+") - "+e.message)}}},e.prototype.pageView=function(e,t){return this.logPageView(e,t),this},e.prototype.logPageView=function(e,t){this.provider&&this.provider.logPageView?this.provider.logPageView(e,t):this.logEvent(new j(Y.APP_PAGE,F.VIEWED,e))},e.prototype.logSearch=function(e,t){this.provider.logSearch&&this.provider.logSearch(e,t)},e}(),k=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.setUrl=function(t){e.prototype.setUrl.call(this,t),this.baseUrl=t+"/api/recommender"},t.prototype.suggest=function(e,t){var r=this,i=this.baseUrl+"/suggest";return this._search(i,e,t).catch(function(e){r.logError("KGService.suggest() - "+e.message);var t=new Error("Error suggesting concepts: "+e.message);throw Object.assign(t,e),t})},t.prototype.types=function(e,t){var r=this,i=this.baseUrl+"/types";return this._search(i,e,t).catch(function(e){r.logError("KGService.types() - "+e.message);var t=new Error("Error searching types: "+e.message);throw Object.assign(t,e),t})},t.prototype.sources=function(e,t){var r=this,i=this.baseUrl+"/sources";return this._search(i,e,t).catch(function(e){r.logError("KGService.sources() - "+e.message);var t=new Error("Error searching sources: "+e.message);throw Object.assign(t,e),t})},t.prototype._search=function(e,t,r){var i=this;return this.createAndResolvePromise(e).then(function(e){var o=t.getQuery(),s=i.buildRequest({method:"GET",url:e,params:o,options:r});return i.execute(s)})},t}(C),Q=function(e,t,r){var i="string"==typeof e?e:e&&e.type?e.type:null;if(!i)throw new Error("Must provide a type or object with a type specified");if(!t)throw new Error("Must provide a base url");if(!r)throw new Error("Must provide an http client to use to make requests");switch(i){case s.LAYER:return new L(t,r);case s.SERVICE:return new U(t,r);case s.MAP:return new D(t,r);case s.GALLERY:return new N(t,r);case s.DATASET:return new _(t,r);default:return new w(t,r)}};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},writable:!0,configurable:!0}),e.AbstractService=C,e.AgolQuery=x,e.AgolService=q,e.AssociationService=M,e.ClientVersion="0.3.0",e.Config=A,e.DatasetService=_,e.GPError=o,e.GPHttpClient=b,e.GalleryService=N,e.ItemService=w,e.ItemTypeLabels=n,e.ItemTypes=s,e.KGClassifiers=g,e.KGQuery=E,e.KGService=k,e.LayerService=L,e.MapService=D,e.Query=R,e.QueryFacets=d,e.QueryFactory=function(){return new R},e.QueryFields=y,e.QueryParameters=l,e.ServiceFactory=Q,e.ServiceService=U,e.TrackingCategories=Y,e.TrackingEvent=j,e.TrackingEventFactory=function e(t,r){var i=[];if(t&&r&&r.type)if(s.MAP===r.type){if(i.push(new j(Y.MAP,t,r)),F.DISPLAYED===t&&(r.layers.forEach(function(r){if(r.layer){var o=e(t,r.layer).filter(function(e){return null!==e});o&&o.length&&(i=i.concat(o))}}),r.baseLayer)){var o=e(t,r.baseLayer).filter(function(e){return null!==e});o&&o.length&&(i=i.concat(o))}}else if(s.LAYER===r.type)i.push(new j(Y.LAYER,t,r)),F.DISPLAYED===t&&r.services&&r.services.length&&i.push(new j(Y.SERVICE,t,r.services[0]));else{var n=function(e){var t=Y.UNKNOWN;if(e){var r=Object.keys(Y).map(function(e){return Y[e]});if(~r.indexOf(e))return e;if(~e.indexOf(":")){var i=e.split(":")[1];if(~r.indexOf(i))return i}}return t}(r.type);i.push(new j(n,t,r))}return i},e.TrackingService=H,e.TrackingTypes=F,e.URIFactory=function(e){if("function"!=typeof e)throw new Error("Must specify a MD5 function when using URIFactory");return function(t){return h.create(t,e)}},e.UtilsService=B,e.XHRHttpClient=O,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=geoplatform-client.umd.min.js.map