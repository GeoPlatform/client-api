"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,r){"function"==typeof define&&define.amd?define(["Q","angular","GeoPlatform","ItemService"],function(t,n,o,i){return e.NGItemService=r(t,n,o,i)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.NGItemService=r(require("Q"),require("angular"),require("GeoPlatform"),require("ItemService")):GeoPlatform.NGItemService=r(Q,angular,GeoPlatform,GeoPlatform.ItemService)}(window,function(e,r,t,n){var o=["GET","POST","PUT","DELETE","PATCH"];return function(n){function i(){_classCallCheck(this,i);var e=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t.ualUrl));if(void 0===r)throw new Error("Angular not defined");return e}return _inherits(i,n),_createClass(i,[{key:"get",value:function(t,n){var o=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");return e(o.buildRequest("GET",o.baseUrl+"/"+t,null,n)).then(function(e){return e.data})}).catch(function(r){var t="NGItemService.get() - Error fetching item: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"save",value:function(t,n){var o=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");var r="POST",i=o.baseUrl;return t.id&&(r="PUT",i+="/"+t.id),e(o.buildRequest(r,i,t,n)).then(function(e){return e.data})}).catch(function(r){var t="NGItemService.save() - Error saving item: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"remove",value:function(t,n){var o=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");return e(o.buildRequest("DELETE",o.baseUrl+"/"+t,null,n))}).catch(function(r){var t="NGItemService.remove() - Error deleting item: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"patch",value:function(t,n,o){var i=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");return e(i.buildRequest("PATCH",i.baseUrl+"/"+t,n,o)).then(function(e){return e.data})}).catch(function(r){var t="NGItemService.patch() - Error patching item: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"search",value:function(t,n){var o=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");var r=t;return t&&void 0!==t.getQuery&&(r=t.getQuery()),e(o.buildRequest("GET",o.baseUrl,r,n)).then(function(e){return e.data})}).catch(function(r){var t="NGItemService.search() - Error searching items: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"buildRequest",value:function(e,r,t,n){if(o.indexOf(e)<0)throw new Error("Unsupported HTTP method "+e);if(!r)throw new Error("Must specify a URL for HTTP requests");var i={method:e,url:r,timeout:this.timeout};if(t&&(i.data=t,"POST"!==e&&"PUT"!==e&&"PATCH"!==e||(i.processData=!1,i.contentType="application/json")),n&&"object"===(void 0===n?"undefined":_typeof(n)))for(var u in n)n.hasOwnProperty(u)&&(i[u]=n[u]);return i}}]),i}(n)}),function(e,r){"function"==typeof define&&define.amd?define(["q","angular","GeoPlatform","NGItemService"],function(t,n,o,i){return e.NGMapService=r(t,n,o,i)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.NGMapService=r(require("q"),require("angular"),require("GeoPlatform"),require("NGItemService")):GeoPlatform.NGMapService=r(Q,angular,GeoPlatform,GeoPlatform.NGItemService)}(window,function(e,r,t,n){return function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this))}return _inherits(r,e),_createClass(r,[{key:"setUrl",value:function(e){this.baseUrl=e+"/api/maps"}}]),r}(n)}),function(e,r){"function"==typeof define&&define.amd?define(["q","angular","GeoPlatform","NGItemService"],function(t,n,o,i){return e.NGLayerService=r(t,n,o,i)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.NGLayerService=r(require("q"),require("angular"),require("GeoPlatform"),require("NGItemService")):GeoPlatform.NGLayerService=r(Q,angular,GeoPlatform,GeoPlatform.NGItemService)}(window,function(e,r,t,n){return function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))}return _inherits(n,t),_createClass(n,[{key:"setUrl",value:function(e){this.baseUrl=e+"/api/layers"}},{key:"style",value:function(t){var n=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");var r=n.baseUrl+"/"+id+"/style";return e(n.buildRequest("GET",r,null,t))}).catch(function(r){var t="GeoPlatform.NGLayerService.style() - Error getting layer style: "+r.message,n=new Error(t);return e.reject(n)})}},{key:"describe",value:function(t,n){var o=this;return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");if(!t)throw new Error("Must provide describe request parameters");var r=["bbox","height","width","x","y"],i=r.find(function(e){return!t[e]});if(i)throw new Error("Must specify "+i+" in describe parameters");var u={srs:"EPSG:4326",bbox:t.bbox,height:t.height,width:t.width,info_format:"text/xml",x:t.x,y:t.y,i:t.x,j:t.y},a=o.baseUrl+"/"+id+"/describe";return e(o.buildRequest("GET",a,u,n))}).catch(function(r){var t="GeoPlatform.NGLayerService.get() - Error describing layer feature: "+r.message,n=new Error(t);return e.reject(n)})}}]),n}(n)}),function(e,r){"function"==typeof define&&define.amd?define(["q","angular","GeoPlatform","NGItemService"],function(t,n,o,i){return e.NGServiceService=r(t,n,o,i)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.NGServiceService=r(require("q"),require("angular"),require("GeoPlatform"),require("NGItemService")):GeoPlatform.NGServiceService=r(Q,angular,GeoPlatform,GeoPlatform.NGItemService)}(window,function(e,r,t,n){return function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))}return _inherits(n,t),_createClass(n,[{key:"setUrl",value:function(e){this.baseUrl=e+"/api/services"}},{key:"about",value:function(t,n){var o=this;if(!t){var i=new Error("Must provide service to get metadata about");return e.reject(i)}return e.resolve(r.injector(["ng"]).get("$http")).then(function(e){if(void 0===e)throw new Error("Angular $http not resolved");return e(o.buildRequest("POST",o.baseUrl+"/about",t,n))}).catch(function(r){var t="NGServiceService.get() - Error describing service: "+r.message,n=new Error(t);return e.reject(n)})}}]),n}(n)}),function(e,r){"function"==typeof define&&define.amd?define(["ItemTypes","NGItemService","NGLayerService","NGMapService","NGServiceService"],function(t,n,o,i,u){return e.NGServiceFactory=r(t,n,o,i)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.NGServiceFactory=r(require("../../shared/types"),require("./item"),require("./layer"),require("./map"),require("./service")):GeoPlatform.NGServiceFactory=r(GeoPlatform.ItemTypes,GeoPlatform.NGItemService,GeoPlatform.NGLayerService,GeoPlatform.NGMapService,GeoPlatform.NGServiceService)}(window,function(e,r,t,n){return function(o,i){var u="string"==typeof o?o:o&&o.type?o.type:null;if(!u)throw new Error("Must provide a type or object with a type specified");if(!i)throw new Error("Must provide a base url");switch(u){case Types.LAYER:return new r(i);case Types.SERVICE:return new n(i);case Types.MAP:return new t(i);default:return new e(i)}}});